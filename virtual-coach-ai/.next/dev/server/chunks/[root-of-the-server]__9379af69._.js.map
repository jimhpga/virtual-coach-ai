{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Sites/virtual-coach-ai/virtual-coach-ai/src/app/api/swing-report/route.ts"],"sourcesContent":["// src/app/api/swing-report/route.ts\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport type { SwingReport } from \"@/types/swingReport\";\r\n\r\nexport const runtime = \"nodejs\";\r\n\r\n// For now this ignores the actual pixels and returns a mock report.\r\n// It still accepts real video uploads so the pipe is tested end-to-end.\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const contentType = req.headers.get(\"content-type\") || \"\";\r\n\r\n    let hasVideo = false;\r\n    if (contentType.includes(\"multipart/form-data\")) {\r\n      const formData = await req.formData();\r\n      const video = formData.get(\"video\");\r\n      if (video && typeof video !== \"string\") {\r\n        hasVideo = true;\r\n      }\r\n    }\r\n\r\n    const now = new Date().toISOString();\r\n\r\n    const report: SwingReport = {\r\n      id: `swing-${Date.now()}`,\r\n      createdAt: now,\r\n      overallScore: hasVideo ? 76 : 72,\r\n      powerScore: 80,\r\n      efficiencyScore: 70,\r\n      consistencyScore: 68,\r\n      dominantMiss: \"push_fade\",\r\n      summary: hasVideo\r\n        ? \"Swing shows solid athletic motion with enough speed, but face and path are slightly mismatched, giving you a gentle push–fade. We’ll clean up setup, takeaway depth, and delivery so you can tighten start lines and control curve without losing your natural motion.\"\r\n        : \"Sample report: this is what your swing breakdown will look like. In a real upload, we’ll tune the checkpoints to your miss pattern and priorities, not a generic template.\",\r\n      issues: [\r\n        {\r\n          id: \"addr_setup\",\r\n          title: \"Setup alignment & ball position\",\r\n          severity: \"medium\",\r\n          position: \"address\",\r\n          description:\r\n            \"Feet and shoulders tend to aim a touch right of target while the face sits more neutral. Ball position drifts too far forward with irons, which pushes start lines right and makes it hard to control low point.\",\r\n          drills: [\r\n            \"Alignment stick routine: one stick on target line, one across toes for 10 balls per session.\",\r\n            \"Ball position checkpoint: mark mid-stance and one ball forward with a tee or club on the ground.\",\r\n          ],\r\n        },\r\n        {\r\n          id: \"p2_takeaway\",\r\n          title: \"Clubhead too outside at P2\",\r\n          severity: \"high\",\r\n          position: \"takeaway\",\r\n          description:\r\n            \"Early takeaway works the clubhead outside the hands with a quick roll of the face. That combination makes the shaft too steep early and encourages an out-to-in path coming down.\",\r\n          drills: [\r\n            \"Half-swing takeaway drill: pause at P2, keep clubhead just inside hands for 3×10 reps.\",\r\n            \"Wall or chair depth drill: rehearse takeaway so the handle works in while the clubhead stays in front.\",\r\n          ],\r\n        },\r\n        {\r\n          id: \"p6_delivery\",\r\n          title: \"Steep delivery with late face control\",\r\n          severity: \"high\",\r\n          position: \"downswing\",\r\n          description:\r\n            \"Club stays a bit too steep into P6 with the handle moving hard left early. Face hangs open and you run out of room, which sends the ball starting right with a soft fade and occasional wipe-slices.\",\r\n          drills: [\r\n            \"Pump drill from P5–P6: feel trail elbow in front of hip while shaft shallows slightly behind hands.\",\r\n            \"Lead-wrist lean drill: three-quarter swings focusing on modest forward shaft lean with a quieter handle exit.\",\r\n          ],\r\n        },\r\n        {\r\n          id: \"impact_strike\",\r\n          title: \"Strike pattern too high on the face\",\r\n          severity: \"medium\",\r\n          position: \"impact\",\r\n          description:\r\n            \"Contact tends to live slightly high on the clubface, costing you ball speed and flattening launch. Combined with the open face, it robs you of distance even when the ball finishes in play.\",\r\n          drills: [\r\n            \"Impact tape or dry-erase dot on the face for 10–15 balls, aiming to stack strikes around the center.\",\r\n            \"Tee-height ladder drill: alternate low/normal tee heights to train centered contact.\",\r\n          ],\r\n        },\r\n        {\r\n          id: \"finish_balance\",\r\n          title: \"Finish balance under pressure\",\r\n          severity: \"low\",\r\n          position: \"finish\",\r\n          description:\r\n            \"On routine swings your finish is solid, but under pressure you tend to stand up early and lose your posted left side. That’s more of a scoring consistency issue than a mechanics disaster.\",\r\n          drills: [\r\n            \"3-second hold drill: every shot in practice, freeze your finish until the ball lands.\",\r\n            \"Pressure ladder: hit 3-ball sets with small targets and hold your finish on every swing.\",\r\n          ],\r\n        },\r\n      ],\r\n      practicePlanSummary:\r\n        \"Days 1–4: lock in alignment and ball position with a simple stick routine, then rehearse takeaway to P2 with slow, paused reps. Days 5–10: blend the new P2 and shallower P6 into three-quarter swings, using strike feedback on the face every session. Days 11–14: take it to the course with one setup key and one swing key only, focusing on start line and centered contact, not swing positions.\",\r\n    };\r\n\r\n    return NextResponse.json(report, { status: 200 });\r\n  } catch (err) {\r\n    console.error(\"Error in /api/swing-report:\", err);\r\n    return NextResponse.json(\r\n      { error: \"Internal server error while generating swing report.\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,oCAAoC;;;;;;;AACpC;;AAGO,MAAM,UAAU;AAIhB,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,cAAc,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB;QAEvD,IAAI,WAAW;QACf,IAAI,YAAY,QAAQ,CAAC,wBAAwB;YAC/C,MAAM,WAAW,MAAM,IAAI,QAAQ;YACnC,MAAM,QAAQ,SAAS,GAAG,CAAC;YAC3B,IAAI,SAAS,OAAO,UAAU,UAAU;gBACtC,WAAW;YACb;QACF;QAEA,MAAM,MAAM,IAAI,OAAO,WAAW;QAElC,MAAM,SAAsB;YAC1B,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,IAAI;YACzB,WAAW;YACX,cAAc,WAAW,KAAK;YAC9B,YAAY;YACZ,iBAAiB;YACjB,kBAAkB;YAClB,cAAc;YACd,SAAS,WACL,2QACA;YACJ,QAAQ;gBACN;oBACE,IAAI;oBACJ,OAAO;oBACP,UAAU;oBACV,UAAU;oBACV,aACE;oBACF,QAAQ;wBACN;wBACA;qBACD;gBACH;gBACA;oBACE,IAAI;oBACJ,OAAO;oBACP,UAAU;oBACV,UAAU;oBACV,aACE;oBACF,QAAQ;wBACN;wBACA;qBACD;gBACH;gBACA;oBACE,IAAI;oBACJ,OAAO;oBACP,UAAU;oBACV,UAAU;oBACV,aACE;oBACF,QAAQ;wBACN;wBACA;qBACD;gBACH;gBACA;oBACE,IAAI;oBACJ,OAAO;oBACP,UAAU;oBACV,UAAU;oBACV,aACE;oBACF,QAAQ;wBACN;wBACA;qBACD;gBACH;gBACA;oBACE,IAAI;oBACJ,OAAO;oBACP,UAAU;oBACV,UAAU;oBACV,aACE;oBACF,QAAQ;wBACN;wBACA;qBACD;gBACH;aACD;YACD,qBACE;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC,QAAQ;YAAE,QAAQ;QAAI;IACjD,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAuD,GAChE;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}