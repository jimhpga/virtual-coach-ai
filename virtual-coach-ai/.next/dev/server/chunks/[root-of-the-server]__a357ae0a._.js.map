{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Sites/virtual-coach-ai/virtual-coach-ai/src/app/api/tts/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport OpenAI from \"openai\";\r\n\r\nconst client = new OpenAI({\r\n  apiKey: process.env.OPENAI_API_KEY,\r\n});\r\n\r\nexport const runtime = \"nodejs\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const { text } = await req.json();\r\n\r\n    if (!text || typeof text !== \"string\") {\r\n      return NextResponse.json(\r\n        { ok: false, error: \"Missing 'text' in request body\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Generate speech using OpenAI text-to-speech\r\n    const audioResponse = await client.audio.speech.create({\r\n      model: \"gpt-4o-mini-tts\", // or \"tts-1\" / \"tts-1-hd\"\r\n      voice: \"alloy\",\r\n      response_format: \"mp3\",\r\n      input: text,\r\n    });\r\n\r\n    const arrayBuffer = await audioResponse.arrayBuffer();\r\n    const base64 = Buffer.from(arrayBuffer).toString(\"base64\");\r\n\r\n    return NextResponse.json({\r\n      ok: true,\r\n      audio: base64,\r\n      mimeType: \"audio/mpeg\",\r\n    });\r\n  } catch (err: any) {\r\n    console.error(\"tts error:\", err);\r\n    return NextResponse.json(\r\n      { ok: false, error: err?.message || \"Unknown error\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;;;AAEA,MAAM,SAAS,IAAI,mLAAM,CAAC;IACxB,QAAQ,QAAQ,GAAG,CAAC,cAAc;AACpC;AAEO,MAAM,UAAU;AAEhB,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI;QAE/B,IAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;YACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,IAAI;gBAAO,OAAO;YAAiC,GACrD;gBAAE,QAAQ;YAAI;QAElB;QAEA,8CAA8C;QAC9C,MAAM,gBAAgB,MAAM,OAAO,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC;YACrD,OAAO;YACP,OAAO;YACP,iBAAiB;YACjB,OAAO;QACT;QAEA,MAAM,cAAc,MAAM,cAAc,WAAW;QACnD,MAAM,SAAS,OAAO,IAAI,CAAC,aAAa,QAAQ,CAAC;QAEjD,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,IAAI;YACJ,OAAO;YACP,UAAU;QACZ;IACF,EAAE,OAAO,KAAU;QACjB,QAAQ,KAAK,CAAC,cAAc;QAC5B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,IAAI;YAAO,OAAO,KAAK,WAAW;QAAgB,GACpD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}