{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Sites/virtual-coach-ai/virtual-coach-ai/src/app/upload/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport type { SwingReport } from \"@/types/swingReport\";\r\n\r\nexport default function UploadPage() {\r\n  const [videoFile, setVideoFile] = useState<File | null>(null);\r\n  const [videoPreviewUrl, setVideoPreviewUrl] = useState<string | null>(null);\r\n  const [report, setReport] = useState<SwingReport | null>(null);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [isSampleLoading, setIsSampleLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0] || null;\r\n    if (!file) return;\r\n\r\n    if (!file.type.startsWith(\"video/\")) {\r\n      setError(\"Please upload a video file (mp4, mov, etc.).\");\r\n      setVideoFile(null);\r\n      setVideoPreviewUrl(null);\r\n      return;\r\n    }\r\n\r\n    setError(null);\r\n    setReport(null);\r\n    setVideoFile(file);\r\n\r\n    const url = URL.createObjectURL(file);\r\n    setVideoPreviewUrl((prev) => {\r\n      if (prev && prev !== url) {\r\n        URL.revokeObjectURL(prev);\r\n      }\r\n      return url;\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!videoFile) {\r\n      setError(\"Please choose a swing video first.\");\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    setError(null);\r\n    setReport(null);\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"video\", videoFile);\r\n\r\n      const res = await fetch(\"/api/swing-report\", {\r\n        method: \"POST\",\r\n        body: formData,\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const data = await res.json().catch(() => null);\r\n        throw new Error(data?.error || \"Failed to generate swing report.\");\r\n      }\r\n\r\n      const data = (await res.json()) as SwingReport;\r\n      setReport(data);\r\n    } catch (err: any) {\r\n      console.error(err);\r\n      setError(err.message || \"Something went wrong generating your report.\");\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleSample = async () => {\r\n    setIsSampleLoading(true);\r\n    setError(null);\r\n    setReport(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/swing-report\", {\r\n        method: \"POST\",\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const data = await res.json().catch(() => null);\r\n        throw new Error(data?.error || \"Failed to load sample report.\");\r\n      }\r\n\r\n      const data = (await res.json()) as SwingReport;\r\n      setReport(data);\r\n    } catch (err: any) {\r\n      console.error(err);\r\n      setError(err.message || \"Something went wrong loading the sample report.\");\r\n    } finally {\r\n      setIsSampleLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-slate-950 text-slate-50 flex flex-col\">\r\n      {/* Top nav */}\r\n      <header className=\"border-b border-slate-800 bg-slate-950/90 backdrop-blur\">\r\n        <div className=\"max-w-6xl mx-auto flex items-center justify-between px-4 py-3\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <div className=\"h-7 w-7 rounded-full bg-emerald-500 flex items-center justify-center text-slate-950 text-sm font-bold\">\r\n              VC\r\n            </div>\r\n            <div className=\"flex flex-col leading-tight\">\r\n              <span className=\"text-sm font-semibold\">VCA Virtual Coach</span>\r\n              <span className=\"text-[11px] text-slate-400\">\r\n                Upload a swing, get a report\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          <nav className=\"flex items-center gap-4 text-xs\">\r\n            <Link href=\"/\" className=\"text-slate-300 hover:text-emerald-400\">\r\n              Home\r\n            </Link>\r\n            <Link\r\n              href=\"/coach\"\r\n              className=\"text-slate-300 hover:text-emerald-400\"\r\n            >\r\n              AI Coach\r\n            </Link>\r\n            <span className=\"text-emerald-400 font-semibold\">\r\n              Upload Swing\r\n            </span>\r\n            <Link\r\n              href=\"/sample-report\"\r\n              className=\"text-slate-300 hover:text-emerald-400\"\r\n            >\r\n              Sample Report\r\n            </Link>\r\n            <Link\r\n              href=\"/about\"\r\n              className=\"text-slate-300 hover:text-emerald-400\"\r\n            >\r\n              About\r\n            </Link>\r\n          </nav>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Main content */}\r\n      <section className=\"flex-1 px-4 py-8\">\r\n        <div className=\"max-w-6xl mx-auto grid gap-6 lg:grid-cols-[minmax(0,1.1fr)_minmax(0,1.1fr)]\">\r\n          {/* Left: upload + video preview */}\r\n          <div className=\"bg-slate-900/80 border border-slate-800 rounded-2xl p-6 shadow-lg space-y-4\">\r\n            <div className=\"space-y-1\">\r\n              <h1 className=\"text-2xl md:text-3xl font-semibold\">\r\n                Upload your swing\r\n              </h1>\r\n              <p className=\"text-sm text-slate-300\">\r\n                Face-on or down-the-line. Just make sure you and the ball stay\r\n                in the frame.\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n              <input\r\n                type=\"file\"\r\n                accept=\"video/*\"\r\n                onChange={handleFileChange}\r\n                className=\"block w-full text-sm text-slate-200\r\n                           file:mr-4 file:py-2 file:px-4\r\n                           file:rounded-full file:border-0\r\n                           file:text-sm file:font-semibold\r\n                           file:bg-emerald-500 file:text-slate-950\r\n                           hover:file:bg-emerald-400\"\r\n              />\r\n              {videoFile && (\r\n                <p className=\"text-xs text-slate-400\">\r\n                  Selected: {videoFile.name}\r\n                </p>\r\n              )}\r\n\r\n              {videoPreviewUrl && (\r\n                <div className=\"mt-2 rounded-xl overflow-hidden border border-slate-800 bg-black\">\r\n                  <video\r\n                    src={videoPreviewUrl}\r\n                    controls\r\n                    className=\"w-full max-h-80 object-contain\"\r\n                  />\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"mt-3 flex flex-wrap gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSubmit}\r\n                  disabled={isSubmitting || !videoFile}\r\n                  className=\"inline-flex items-center justify-center rounded-full px-6 py-2 text-sm font-semibold\r\n                             bg-emerald-500 text-slate-950 disabled:opacity-50 disabled:cursor-not-allowed\r\n                             hover:bg-emerald-400 transition\"\r\n                >\r\n                  {isSubmitting ? \"Analyzing swing…\" : \"Analyze my swing\"}\r\n                </button>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleSample}\r\n                  disabled={isSampleLoading}\r\n                  className=\"inline-flex items-center justify-center rounded-full px-6 py-2 text-sm font-semibold\r\n                             border border-slate-600 text-slate-100 disabled:opacity-50 disabled:cursor-not-allowed\r\n                             hover:bg-slate-800 transition\"\r\n                >\r\n                  {isSampleLoading ? \"Loading sample…\" : \"See sample report\"}\r\n                </button>\r\n              </div>\r\n\r\n              {error && (\r\n                <p className=\"text-xs text-red-400 mt-2\">\r\n                  {error}\r\n                </p>\r\n              )}\r\n\r\n              {!error && !report && !isSubmitting && !isSampleLoading && (\r\n                <p className=\"text-[11px] text-slate-500\">\r\n                  For now, analysis uses a sample engine. We’ll plug in full\r\n                  video-based AI once the pipe is rock solid.\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Right: report */}\r\n          <div className=\"space-y-4\">\r\n            {report ? (\r\n              <ReportView report={report} />\r\n            ) : (\r\n              <div className=\"h-full flex items-center justify-center rounded-2xl border border-dashed border-slate-700 bg-slate-900/40 p-6 text-sm text-slate-400 text-center\">\r\n                <span>\r\n                  Your swing report will appear here after you{\" \"}\r\n                  <span className=\"font-semibold text-slate-200\">upload</span>{\" \"}\r\n                  and{\" \"}\r\n                  <span className=\"font-semibold text-slate-200\">\r\n                    analyze\r\n                  </span>{\" \"}\r\n                  a video (or load the sample).\r\n                </span>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </main>\r\n  );\r\n}\r\n\r\nfunction ReportView({ report }: { report: SwingReport }) {\r\n  return (\r\n    <div className=\"bg-slate-900/80 border border-slate-800 rounded-2xl p-5 space-y-4 shadow-lg text-sm\">\r\n      <header className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-2\">\r\n        <div>\r\n          <h2 className=\"text-base font-semibold text-slate-100\">\r\n            Swing Report\r\n          </h2>\r\n          <p className=\"text-[11px] text-slate-400\">\r\n            Generated: {new Date(report.createdAt).toLocaleString()}\r\n          </p>\r\n        </div>\r\n        <div className=\"flex flex-wrap gap-2 text-[11px]\">\r\n          <StatPill label=\"Overall\" value={report.overallScore} />\r\n          <StatPill label=\"Power\" value={report.powerScore} />\r\n          <StatPill label=\"Efficiency\" value={report.efficiencyScore} />\r\n          <StatPill label=\"Consistency\" value={report.consistencyScore} />\r\n          <span className=\"inline-flex items-center rounded-full border border-slate-700 px-3 py-1 text-slate-200\">\r\n            Miss pattern:{\" \"}\r\n            <span className=\"ml-1 font-semibold capitalize\">\r\n              {report.dominantMiss}\r\n            </span>\r\n          </span>\r\n        </div>\r\n      </header>\r\n\r\n      <p className=\"text-slate-200 text-xs leading-relaxed\">\r\n        {report.summary}\r\n      </p>\r\n\r\n      <div className=\"grid md:grid-cols-3 gap-3\">\r\n        {report.issues.map((issue) => (\r\n          <article\r\n            key={issue.id}\r\n            className=\"bg-slate-950/60 border border-slate-800 rounded-xl p-3 space-y-2 text-[11px]\"\r\n          >\r\n            <div className=\"flex items-center justify-between gap-2\">\r\n              <h3 className=\"font-semibold text-slate-100\">\r\n                {issue.title}\r\n              </h3>\r\n              <SeverityBadge severity={issue.severity} />\r\n            </div>\r\n            <p className=\"text-slate-300\">\r\n              <span className=\"font-semibold\">\r\n                Position: {issue.position.replace(\"_\", \" \")}\r\n              </span>\r\n            </p>\r\n            <p className=\"text-slate-300\">{issue.description}</p>\r\n            <div>\r\n              <p className=\"font-semibold text-slate-200 mb-1\">Drills:</p>\r\n              <ul className=\"list-disc list-inside space-y-1 text-slate-300\">\r\n                {issue.drills.map((d, i) => (\r\n                  <li key={i}>{d}</li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          </article>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"mt-1 bg-slate-950/60 border border-slate-800 rounded-xl p-3\">\r\n        <h3 className=\"text-[11px] font-semibold text-slate-100 mb-1\">\r\n          14-Day Practice Focus\r\n        </h3>\r\n        <p className=\"text-[11px] text-slate-300\">\r\n          {report.practicePlanSummary}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction StatPill({ label, value }: { label: string; value: number }) {\r\n  return (\r\n    <span className=\"inline-flex items-center rounded-full border border-slate-700 px-3 py-1 text-slate-100 gap-1\">\r\n      <span className=\"text-[11px] text-slate-400\">{label}</span>\r\n      <span className=\"text-xs font-semibold\">{value}</span>\r\n    </span>\r\n  );\r\n}\r\n\r\nfunction SeverityBadge({\r\n  severity,\r\n}: {\r\n  severity: \"low\" | \"medium\" | \"high\";\r\n}) {\r\n  const label =\r\n    severity === \"low\" ? \"Low\" : severity === \"medium\" ? \"Medium\" : \"High\";\r\n\r\n  return (\r\n    <span className=\"inline-flex items-center rounded-full px-2 py-1 text-[10px] font-semibold border border-slate-700\">\r\n      {label} priority\r\n    </span>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}