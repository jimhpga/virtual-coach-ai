{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Sites/virtual-coach-ai/virtual-coach-ai/src/app/coach/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\ntype ReportCheckpoint = {\r\n  id: string;\r\n  label: string;\r\n  status: \"ON_TRACK\" | \"NEEDS_ATTENTION\" | \"PRIORITY\";\r\n  phase: string;\r\n  coachNotes: string;\r\n  commonMisses: string[];\r\n  keyDrills: string[];\r\n};\r\n\r\ntype FullSwingReport = {\r\n  playerOverview: string;\r\n  scores: {\r\n    overall: number;\r\n    power: number;\r\n    reliability: number;\r\n    consistency: number;\r\n  };\r\n  strengths: string[];\r\n  leaks: string[];\r\n  topFixes: string[];\r\n  checkpoints: ReportCheckpoint[];\r\n  practicePlan14Day: string[];\r\n};\r\n\r\ntype SavedReport = {\r\n  id: string;\r\n  playerName: string;\r\n  createdAt: string;\r\n  report: FullSwingReport;\r\n};\r\n\r\ntype VideoAnalysis = {\r\n  summary: string;\r\n  keyPositions: {\r\n    label: string;\r\n    focus: string;\r\n    notes: string;\r\n  }[];\r\n  matchesToCheckpoints: string[];\r\n  swingKeysOnCourse: string[];\r\n};\r\n\r\nconst STORAGE_KEY = \"virtual-coach-saved-reports\";\r\n\r\nfunction StatusBadge({ status }: { status: ReportCheckpoint[\"status\"] }) {\r\n  let label = \"\";\r\n  let color = \"\";\r\n\r\n  switch (status) {\r\n    case \"ON_TRACK\":\r\n      label = \"On Track\";\r\n      color = \"bg-emerald-500/15 text-emerald-300 border-emerald-500/40\";\r\n      break;\r\n    case \"NEEDS_ATTENTION\":\r\n      label = \"Needs Attention\";\r\n      color = \"bg-amber-500/15 text-amber-300 border-amber-500/40\";\r\n      break;\r\n    case \"PRIORITY\":\r\n      label = \"Priority\";\r\n      color = \"bg-red-500/15 text-red-300 border-red-500/40\";\r\n      break;\r\n    default:\r\n      label = status;\r\n      color = \"bg-slate-700/60 text-slate-200 border-slate-500/40\";\r\n  }\r\n\r\n  return (\r\n    <span\r\n      className={`inline-flex items-center rounded-full border px-2 py-[2px] text-[10px] font-semibold uppercase tracking-wide ${color}`}\r\n    >\r\n      {label}\r\n    </span>\r\n  );\r\n}\r\n\r\nexport default function CoachPage() {\r\n  const [playerName, setPlayerName] = useState(\"Player\");\r\n  const [age, setAge] = useState(\"\");\r\n  const [handicap, setHandicap] = useState(\"\");\r\n  const [typicalBallFlight, setTypicalBallFlight] = useState(\"Slight fade\");\r\n  const [typicalMiss, setTypicalMiss] = useState(\"Low pull\");\r\n  const [goals, setGoals] = useState(\r\n    \"More fairways with driver and more solid irons.\"\r\n  );\r\n  const [notes, setNotes] = useState(\r\n    \"Struggles with consistency under pressure and with longer clubs.\"\r\n  );\r\n\r\n  const [report, setReport] = useState<FullSwingReport | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const [audioLoading, setAudioLoading] = useState(false);\r\n  const audioRef = useRef<HTMLAudioElement | null>(null);\r\n\r\n  const [savedReports, setSavedReports] = useState<SavedReport[]>([]);\r\n  const [saving, setSaving] = useState(false);\r\n\r\n  // Video upload state\r\n  const [videoUrl, setVideoUrl] = useState<string | null>(null);\r\n  const [videoName, setVideoName] = useState<string | null>(null);\r\n  const previousVideoUrl = useRef<string | null>(null);\r\n\r\n  // Video analysis state\r\n  const [videoAnalysis, setVideoAnalysis] = useState<VideoAnalysis | null>(null);\r\n  const [videoAnalyzing, setVideoAnalyzing] = useState(false);\r\n\r\n  // Q&A near the video\r\n  const [qaQuestion, setQaQuestion] = useState(\"\");\r\n  const [qaAnswer, setQaAnswer] = useState<string | null>(null);\r\n  const [qaLoading, setQaLoading] = useState(false);\r\n\r\n  // Checkpoint expand/collapse\r\n  const [expandedIds, setExpandedIds] = useState<string[]>([]);\r\n\r\n  // Simple two-step view: \"input\" vs \"report\"\r\n  const [view, setView] = useState<\"input\" | \"report\">(\"input\");\r\n\r\n  // Practice plan collapsed?\r\n  const [planOpen, setPlanOpen] = useState(false);\r\n\r\n  // Load saved reports from localStorage on mount\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n    try {\r\n      const raw = window.localStorage.getItem(STORAGE_KEY);\r\n      if (!raw) return;\r\n      const parsed = JSON.parse(raw) as SavedReport[];\r\n      if (Array.isArray(parsed)) {\r\n        setSavedReports(parsed);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n  }, []);\r\n\r\n  // Save reports to localStorage when list changes\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n    try {\r\n      window.localStorage.setItem(STORAGE_KEY, JSON.stringify(savedReports));\r\n    } catch {\r\n      // ignore\r\n    }\r\n  }, [savedReports]);\r\n\r\n  // Cleanup old object URLs when video changes/unmounts\r\n  useEffect(() => {\r\n    return () => {\r\n      if (previousVideoUrl.current) {\r\n        URL.revokeObjectURL(previousVideoUrl.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  async function handleGenerateReport() {\r\n    setLoading(true);\r\n    setError(null);\r\n    setReport(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/full-swing-report\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          playerName,\r\n          age,\r\n          handicap,\r\n          typicalBallFlight,\r\n          typicalMiss,\r\n          goals,\r\n          notes,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok || !data.ok) {\r\n        throw new Error(data.error || \"Request failed\");\r\n      }\r\n\r\n      setReport(data.report as FullSwingReport);\r\n      setView(\"report\");\r\n    } catch (e: any) {\r\n      console.error(e);\r\n      setError(e.message || \"Something went wrong.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function handlePlayOverview() {\r\n    if (!report || !report.playerOverview) return;\r\n\r\n    setAudioLoading(true);\r\n    try {\r\n      const res = await fetch(\"/api/tts\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ text: report.playerOverview }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok || !data.ok) {\r\n        throw new Error(data.error || \"TTS request failed\");\r\n      }\r\n\r\n      const url = `data:${data.mimeType || \"audio/mpeg\"};base64,${data.audio}`;\r\n\r\n      if (audioRef.current) {\r\n        audioRef.current.pause();\r\n      }\r\n\r\n      const audio = new Audio(url);\r\n      audioRef.current = audio;\r\n      audio.play();\r\n    } catch (e: any) {\r\n      console.error(e);\r\n      setError(e.message || \"Failed to play audio.\");\r\n    } finally {\r\n      setAudioLoading(false);\r\n    }\r\n  }\r\n\r\n  function handleResetForm() {\r\n    setPlayerName(\"Player\");\r\n    setAge(\"\");\r\n    setHandicap(\"\");\r\n    setTypicalBallFlight(\"Slight fade\");\r\n    setTypicalMiss(\"Low pull\");\r\n    setGoals(\"More fairways with driver and more solid irons.\");\r\n    setNotes(\"Struggles with consistency under pressure and with longer clubs.\");\r\n    setReport(null);\r\n    setError(null);\r\n    setVideoUrl(null);\r\n    setVideoName(null);\r\n    setVideoAnalysis(null);\r\n    setQaQuestion(\"\");\r\n    setQaAnswer(null);\r\n    setExpandedIds([]);\r\n    setPlanOpen(false);\r\n    setView(\"input\");\r\n  }\r\n\r\n  function handlePrintReport() {\r\n    if (!report) {\r\n      setError(\"Generate a report before printing.\");\r\n      return;\r\n    }\r\n    if (typeof window !== \"undefined\") {\r\n      window.print();\r\n    }\r\n  }\r\n\r\n  function handleSaveReport() {\r\n    if (!report) {\r\n      setError(\"Generate a report before saving.\");\r\n      return;\r\n    }\r\n    setSaving(true);\r\n    try {\r\n      const id = `${Date.now()}`;\r\n      const createdAt = new Date().toISOString();\r\n      const newSaved: SavedReport = {\r\n        id,\r\n        playerName: playerName || \"Player\",\r\n        createdAt,\r\n        report,\r\n      };\r\n      setSavedReports((prev) => [newSaved, ...prev].slice(0, 20));\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }\r\n\r\n  function handleLoadSavedReport(saved: SavedReport) {\r\n    setReport(saved.report);\r\n    setPlayerName(saved.playerName);\r\n    setError(null);\r\n    setView(\"report\");\r\n  }\r\n\r\n  async function handleCopyDrill(drill: string) {\r\n    try {\r\n      if (typeof navigator !== \"undefined\" && navigator.clipboard) {\r\n        await navigator.clipboard.writeText(drill);\r\n      }\r\n    } catch (e) {\r\n      console.error(\"clipboard error\", e);\r\n    }\r\n  }\r\n\r\n  function handleVideoChange(e: any) {\r\n    const file = e.target.files?.[0];\r\n    if (!file) {\r\n      setVideoUrl(null);\r\n      setVideoName(null);\r\n      setVideoAnalysis(null);\r\n      return;\r\n    }\r\n\r\n    if (previousVideoUrl.current) {\r\n      URL.revokeObjectURL(previousVideoUrl.current);\r\n    }\r\n\r\n    const url = URL.createObjectURL(file);\r\n    previousVideoUrl.current = url;\r\n    setVideoUrl(url);\r\n    setVideoName(file.name);\r\n    setVideoAnalysis(null);\r\n    setQaAnswer(null);\r\n  }\r\n\r\n  async function handleAnalyzeVideo() {\r\n    if (!videoUrl && !notes && !typicalBallFlight && !typicalMiss) {\r\n      setError(\"Add some notes or a video before running analysis.\");\r\n      return;\r\n    }\r\n\r\n    setVideoAnalyzing(true);\r\n    setError(null);\r\n    setVideoAnalysis(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/video-analysis\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          playerName,\r\n          typicalBallFlight,\r\n          typicalMiss,\r\n          goals,\r\n          notes,\r\n          videoName,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok || !data.ok) {\r\n        throw new Error(data.error || \"Video analysis request failed\");\r\n      }\r\n\r\n      setVideoAnalysis(data.analysis as VideoAnalysis);\r\n    } catch (e: any) {\r\n      console.error(e);\r\n      setError(e.message || \"Failed to analyze video.\");\r\n    } finally {\r\n      setVideoAnalyzing(false);\r\n    }\r\n  }\r\n\r\n  async function handleAskQuestion() {\r\n    if (!qaQuestion.trim()) return;\r\n\r\n    setQaLoading(true);\r\n    setQaAnswer(null);\r\n    setError(null);\r\n\r\n    const context = `\r\nPlayer: ${playerName}\r\nBall flight: ${typicalBallFlight}\r\nMiss: ${typicalMiss}\r\nGoals: ${goals}\r\nNotes: ${notes}\r\nVideo file: ${videoName || \"none\"}\r\n`.trim();\r\n\r\n    try {\r\n      const res = await fetch(\"/api/test-ai\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          prompt: `Context:\\n${context}\\n\\nPlayer question about this swing:\\n${qaQuestion}`,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok || !data.ok) {\r\n        throw new Error(data.error || \"Question request failed\");\r\n      }\r\n\r\n      setQaAnswer(data.answer as string);\r\n    } catch (e: any) {\r\n      console.error(e);\r\n      setError(e.message || \"Failed to answer question.\");\r\n    } finally {\r\n      setQaLoading(false);\r\n    }\r\n  }\r\n\r\n  function toggleCheckpoint(id: string) {\r\n    setExpandedIds((prev) =>\r\n      prev.includes(id) ? prev.filter((x) => x !== id) : [...prev, id]\r\n    );\r\n  }\r\n\r\n  function shortText(text: string) {\r\n    if (!text) return \"\";\r\n    const firstSentence = text.split(/(?<=[.!?])\\s+/)[0];\r\n    return firstSentence.length > 180\r\n      ? firstSentence.slice(0, 177) + \"...\"\r\n      : firstSentence;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"min-h-screen text-slate-100\"\r\n      style={{\r\n        backgroundImage: \"url('/golf-bg.jpg')\", // ensure /public/golf-bg.jpg exists\r\n        backgroundSize: \"cover\",\r\n        backgroundPosition: \"center\",\r\n        backgroundAttachment: \"fixed\",\r\n      }}\r\n    >\r\n      <div className=\"min-h-screen bg-slate-950/85\">\r\n        <div className=\"mx-auto flex w-full max-w-6xl flex-col gap-4 p-6 pb-10\">\r\n          {/* Top navigation bar with logo */}\r\n          <nav className=\"mb-1 flex items-center justify-between rounded-full border border-slate-800 bg-slate-950/90 px-4 py-2 text-xs backdrop-blur\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"flex items-center gap-2 pr-3 border-r border-slate-800/70\">\r\n                <img\r\n                  src=\"/logo.svg\" // ensure /public/logo.svg exists\r\n                  alt=\"Virtual Coach AI\"\r\n                  className=\"h-6 w-auto\"\r\n                />\r\n                <span className=\"text-[11px] font-semibold tracking-wide text-slate-200 uppercase\">\r\n                  Virtual Coach AI\r\n                </span>\r\n              </div>\r\n              <a\r\n                href=\"/\"\r\n                className=\"rounded-full bg-slate-900 px-3 py-1 font-semibold text-slate-100 hover:bg-slate-800\"\r\n              >\r\n                ← Back to home\r\n              </a>\r\n              <button\r\n                onClick={handleResetForm}\r\n                className=\"rounded-full bg-slate-900 px-3 py-1 font-semibold text-slate-100 hover:bg-slate-800\"\r\n              >\r\n                Upload another swing\r\n              </button>\r\n              <div className=\"ml-2 flex gap-1 rounded-full bg-slate-900 px-1 py-1\">\r\n                <button\r\n                  onClick={() => setView(\"input\")}\r\n                  className={`rounded-full px-3 py-1 text-[11px] font-semibold ${\r\n                    view === \"input\"\r\n                      ? \"bg-slate-700 text-slate-50\"\r\n                      : \"text-slate-300\"\r\n                  }`}\r\n                >\r\n                  Upload\r\n                </button>\r\n                <button\r\n                  onClick={() => setView(\"report\")}\r\n                  disabled={!report}\r\n                  className={`rounded-full px-3 py-1 text-[11px] font-semibold ${\r\n                    view === \"report\"\r\n                      ? \"bg-slate-700 text-slate-50\"\r\n                      : \"text-slate-300\"\r\n                  } ${!report ? \"opacity-40\" : \"\"}`}\r\n                >\r\n                  Report\r\n                </button>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <button\r\n                onClick={handleSaveReport}\r\n                disabled={saving || !report}\r\n                className=\"rounded-full bg-slate-800 px-3 py-1 font-semibold text-slate-100 disabled:opacity-60\"\r\n              >\r\n                {saving ? \"Saving...\" : \"Save report\"}\r\n              </button>\r\n              <button\r\n                onClick={handlePrintReport}\r\n                className=\"rounded-full bg-emerald-500 px-3 py-1 font-semibold text-emerald-950 hover:bg-emerald-400\"\r\n              >\r\n                Print / PDF\r\n              </button>\r\n            </div>\r\n          </nav>\r\n\r\n          {/* Header */}\r\n          <header className=\"flex flex-col gap-2 border-b border-slate-800/70 pb-4\">\r\n            <h1 className=\"text-3xl font-bold tracking-tight\">\r\n              Virtual Coach AI\r\n            </h1>\r\n            <p className=\"max-w-3xl text-sm text-slate-300\">\r\n              Generate a structured full-swing report from a single set of notes.\r\n              Fill in the player details, attach a swing video, hit{\" \"}\r\n              <span className=\"font-semibold\">Generate Report</span>, and the AI\r\n              will build an overview, checkpoints, and a 14-day practice plan.\r\n            </p>\r\n          </header>\r\n\r\n          {/* INPUT VIEW */}\r\n          {view === \"input\" && (\r\n            <>\r\n              {/* Input form + video upload */}\r\n              <section className=\"grid gap-4 rounded-2xl border border-slate-800 bg-slate-900/70 p-5 md:grid-cols-3\">\r\n                <div className=\"space-y-3 md:col-span-2\">\r\n                  <div className=\"grid gap-3 md:grid-cols-3\">\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-300\">\r\n                        Player name\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={playerName}\r\n                        onChange={(e) => setPlayerName(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-300\">\r\n                        Age\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={age}\r\n                        onChange={(e) => setAge(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-300\">\r\n                        Handicap / scoring average\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={handicap}\r\n                        onChange={(e) => setHandicap(e.target.value)}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid gap-3 md:grid-cols-2\">\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-300\">\r\n                        Typical ball flight\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={typicalBallFlight}\r\n                        onChange={(e) => setTypicalBallFlight(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-300\">\r\n                        Most common miss\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={typicalMiss}\r\n                        onChange={(e) => setTypicalMiss(e.target.value)}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"text-xs font-medium text-slate-300\">\r\n                      Goals for your full swing\r\n                    </label>\r\n                    <textarea\r\n                      className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950 px-2 py-2 text-sm outline-none focus:border-emerald-500\"\r\n                      rows={2}\r\n                      value={goals}\r\n                      onChange={(e) => setGoals(e.target.value)}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"text-xs font-medium text-slate-300\">\r\n                      Notes from lesson / self-diagnosis\r\n                    </label>\r\n                    <textarea\r\n                      className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950 px-2 py-2 text-sm outline-none focus:border-emerald-500\"\r\n                      rows={3}\r\n                      value={notes}\r\n                      onChange={(e) => setNotes(e.target.value)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex flex-col justify-between gap-4 rounded-xl border border-slate-800 bg-slate-950/80 p-4\">\r\n                  <div className=\"space-y-3 text-sm text-slate-300\">\r\n                    <p className=\"font-semibold text-slate-100\">\r\n                      How this report is generated\r\n                    </p>\r\n                    <p className=\"text-xs text-slate-300\">\r\n                      Your inputs (and optionally your swing video) stay on your\r\n                      device. The written notes are sent securely to Virtual Coach\r\n                      AI to build a structured report: scores, checkpoints, and a\r\n                      14-day practice plan.\r\n                    </p>\r\n\r\n                    <div className=\"mt-2 space-y-1\">\r\n                      <label className=\"text-xs font-medium text-slate-300\">\r\n                        Swing video (optional)\r\n                      </label>\r\n                      <input\r\n                        type=\"file\"\r\n                        accept=\"video/*\"\r\n                        onChange={handleVideoChange}\r\n                        className=\"block w-full text-[11px] text-slate-300 file:mr-3 file:rounded-md file:border-0 file:bg-slate-800 file:px-3 file:py-1.5 file:text-xs file:font-semibold file:text-slate-100 hover:file:bg-slate-700\"\r\n                      />\r\n                      {videoName && (\r\n                        <p className=\"text-[11px] text-slate-400 truncate\">\r\n                          Selected: {videoName}\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <button\r\n                    onClick={handleGenerateReport}\r\n                    disabled={loading}\r\n                    className=\"mt-2 inline-flex items-center justify-center rounded-md bg-emerald-500 px-4 py-2 text-sm font-semibold text-emerald-950 shadow-sm disabled:opacity-60\"\r\n                  >\r\n                    {loading ? \"Generating report...\" : \"Generate Full Swing Report\"}\r\n                  </button>\r\n                  {error && (\r\n                    <p className=\"text-xs text-red-400\">Error: {error}</p>\r\n                  )}\r\n                </div>\r\n              </section>\r\n\r\n              {/* Small video preview + Q&A */}\r\n              {videoUrl && (\r\n                <section className=\"rounded-2xl border border-slate-800 bg-slate-900/70 p-4\">\r\n                  <div className=\"mb-2 flex items-center justify-between gap-2\">\r\n                    <h2 className=\"text-sm font-semibold tracking-tight text-slate-100\">\r\n                      Swing video & quick questions\r\n                    </h2>\r\n                    <button\r\n                      onClick={handleAnalyzeVideo}\r\n                      disabled={videoAnalyzing}\r\n                      className=\"rounded-full bg-emerald-500 px-3 py-1 text-[11px] font-semibold text-emerald-950 disabled:opacity-60\"\r\n                    >\r\n                      {videoAnalyzing ? \"Analyzing...\" : \"Analyze video with AI\"}\r\n                    </button>\r\n                  </div>\r\n                  <div className=\"grid gap-4 md:grid-cols-[auto,1fr] items-start\">\r\n                    <div className=\"rounded-xl bg-black px-3 py-2 max-w-xs\">\r\n                      <video\r\n                        controls\r\n                        src={videoUrl}\r\n                        className=\"w-full rounded-md\"\r\n                      />\r\n                      <p className=\"mt-1 text-[11px] text-slate-400 text-center\">\r\n                        Small preview – just to see the motion.\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"flex flex-col gap-3\">\r\n                      <div className=\"rounded-xl border border-slate-800 bg-slate-950/80 p-3\">\r\n                        <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-slate-400\">\r\n                          Ask a follow-up question\r\n                        </p>\r\n                        <p className=\"mb-2 text-[11px] text-slate-400\">\r\n                          Answered using this swing, your ball flight, miss\r\n                          pattern, goals, and notes.\r\n                        </p>\r\n                        <textarea\r\n                          className=\"w-full rounded-md border border-slate-700 bg-slate-950 px-2 py-2 text-sm outline-none focus:border-emerald-500\"\r\n                          rows={3}\r\n                          value={qaQuestion}\r\n                          onChange={(e) => setQaQuestion(e.target.value)}\r\n                          placeholder=\"Example: What one feel should I use with this driver swing on the course?\"\r\n                        />\r\n                        <button\r\n                          onClick={handleAskQuestion}\r\n                          disabled={qaLoading || !qaQuestion.trim()}\r\n                          className=\"mt-2 inline-flex items-center justify-center rounded-md bg-slate-800 px-3 py-1.5 text-xs font-semibold text-slate-100 disabled:opacity-50\"\r\n                        >\r\n                          {qaLoading ? \"Thinking...\" : \"Ask about this swing\"}\r\n                        </button>\r\n                      </div>\r\n                      {qaAnswer && (\r\n                        <div className=\"rounded-xl border border-slate-800 bg-slate-950/80 p-3\">\r\n                          <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-slate-400\">\r\n                            Coach answer\r\n                          </p>\r\n                          <p className=\"text-[13px] leading-relaxed text-slate-200 whitespace-pre-wrap\">\r\n                            {qaAnswer}\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n                      {!qaAnswer && videoAnalysis && (\r\n                        <div className=\"rounded-xl border border-slate-800 bg-slate-950/80 p-3\">\r\n                          <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-slate-400\">\r\n                            Video analysis (AI)\r\n                          </p>\r\n                          <p className=\"text-[12px] leading-relaxed text-slate-200\">\r\n                            {videoAnalysis.summary}\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </section>\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          {/* REPORT VIEW */}\r\n          {view === \"report\" && report && (\r\n            <section className=\"space-y-4\">\r\n              <div className=\"grid gap-4 md:grid-cols-[2fr,1.1fr]\">\r\n                <div className=\"space-y-4\">\r\n                  {/* Player overview */}\r\n                  <div className=\"rounded-2xl border border-slate-800 bg-slate-900/75 p-4\">\r\n                    <div className=\"flex flex-wrap items-center justify-between gap-2\">\r\n                      <div>\r\n                        <h2 className=\"text-lg font-semibold tracking-tight\">\r\n                          Player Overview\r\n                        </h2>\r\n                        <p className=\"mt-1 text-[11px] text-slate-400\">\r\n                          Where you are now and how we'll sharpen your full swing.\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <button\r\n                          onClick={handlePlayOverview}\r\n                          disabled={audioLoading}\r\n                          className=\"inline-flex items-center rounded-full bg-slate-800 px-3 py-1 text-[11px] font-semibold text-slate-100 disabled:opacity-60\"\r\n                        >\r\n                          {audioLoading ? \"Preparing audio...\" : \"▶ Play overview\"}\r\n                        </button>\r\n                        <span className=\"rounded-full bg-emerald-500/10 px-2 py-[2px] text-[10px] font-semibold uppercase tracking-wide text-emerald-300\">\r\n                          Generated by Virtual Coach AI\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                    <p className=\"mt-3 text-sm leading-relaxed text-slate-200 whitespace-pre-wrap\">\r\n                      {report.playerOverview}\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Power & Reliability */}\r\n                  <div className=\"rounded-2xl border border-slate-800 bg-slate-900/75 p-4\">\r\n                    <h3 className=\"text-sm font-semibold tracking-tight text-slate-100\">\r\n                      Power &amp; Reliability\r\n                    </h3>\r\n                    <p className=\"mt-1 text-[11px] text-slate-400\">\r\n                      Scores estimated from your notes and described patterns. They\r\n                      should roughly match the story in the overview.\r\n                    </p>\r\n\r\n                    <div className=\"mt-3 space-y-2\">\r\n                      <ScoreRow label=\"Overall\" value={report.scores.overall} />\r\n                      <ScoreRow label=\"Power\" value={report.scores.power} />\r\n                      <ScoreRow\r\n                        label=\"Reliability\"\r\n                        value={report.scores.reliability}\r\n                      />\r\n                      <ScoreRow\r\n                        label=\"Consistency\"\r\n                        value={report.scores.consistency}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Three boxes side by side */}\r\n                  <div className=\"grid gap-4 md:grid-cols-3\">\r\n                    <div className=\"rounded-2xl border border-slate-800 bg-slate-900/75 p-4 text-sm\">\r\n                      <ListBlock title=\"What you do well\" items={report.strengths} />\r\n                    </div>\r\n                    <div className=\"rounded-2xl border border-slate-800 bg-slate-900/75 p-4 text-sm\">\r\n                      <ListBlock title=\"Where your leaks are\" items={report.leaks} />\r\n                    </div>\r\n                    <div className=\"rounded-2xl border border-slate-800 bg-slate-900/75 p-4 text-sm\">\r\n                      <ListBlock\r\n                        title=\"Top 3 power moves\"\r\n                        items={report.topFixes}\r\n                        numbered\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* P1–P9 Checkpoints */}\r\n                  <div className=\"rounded-2xl border border-slate-800 bg-slate-900/75 p-4\">\r\n                    <div className=\"mb-3 flex items-center justify-between\">\r\n                      <h3 className=\"text-sm font-semibold tracking-tight text-slate-100\">\r\n                        P1–P9 Checkpoints\r\n                      </h3>\r\n                      <p className=\"text-[11px] text-slate-400\">\r\n                        Short summary on each row. Click to see full description,\r\n                        misses, and drills.\r\n                      </p>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      {report.checkpoints.map((cp, index) => {\r\n                        const id = cp.id || `cp-${index}`;\r\n                        const expanded = expandedIds.includes(id);\r\n                        return (\r\n                          <div\r\n                            key={id}\r\n                            className=\"rounded-xl border border-slate-800 bg-slate-950/70\"\r\n                          >\r\n                            <button\r\n                              onClick={() => toggleCheckpoint(id)}\r\n                              className=\"flex w-full items-center justify-between gap-3 px-3 py-2 text-left\"\r\n                            >\r\n                              <div className=\"flex flex-col gap-[2px]\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <span className=\"text-[11px] font-semibold uppercase tracking-wide text-slate-400\">\r\n                                    {cp.phase || `P${index + 1}`}\r\n                                  </span>\r\n                                  <span className=\"text-[11px] text-slate-500\">\r\n                                    P{index + 1}\r\n                                  </span>\r\n                                </div>\r\n                                <p className=\"text-sm font-semibold text-slate-100\">\r\n                                  {cp.label}\r\n                                </p>\r\n                                <p className=\"text-[11px] text-slate-300\">\r\n                                  {shortText(cp.coachNotes)}\r\n                                </p>\r\n                              </div>\r\n                              <div className=\"flex flex-col items-end gap-1\">\r\n                                <StatusBadge status={cp.status} />\r\n                                <span className=\"text-[11px] text-slate-400\">\r\n                                  {expanded ? \"Hide details ▲\" : \"Show details ▼\"}\r\n                                </span>\r\n                              </div>\r\n                            </button>\r\n\r\n                            {expanded && (\r\n                              <div className=\"border-t border-slate-800 px-3 py-3 text-[11px] text-slate-200\">\r\n                                <p className=\"mb-2 text-[13px] leading-relaxed\">\r\n                                  {cp.coachNotes}\r\n                                </p>\r\n                                <div className=\"grid gap-2 md:grid-cols-3\">\r\n                                  <div>\r\n                                    <p className=\"font-semibold text-slate-200\">\r\n                                      Common misses\r\n                                    </p>\r\n                                    <ul className=\"mt-1 space-y-[2px]\">\r\n                                      {cp.commonMisses.map((m, i) => (\r\n                                        <li key={i}>• {m}</li>\r\n                                      ))}\r\n                                    </ul>\r\n                                  </div>\r\n                                  <div className=\"md:col-span-2\">\r\n                                    <p className=\"font-semibold text-slate-200\">\r\n                                      Key drills\r\n                                    </p>\r\n                                    <ul className=\"mt-1 space-y-[2px]\">\r\n                                      {cp.keyDrills.map((d, i) => (\r\n                                        <li\r\n                                          key={i}\r\n                                          className=\"flex items-center justify-between gap-2\"\r\n                                        >\r\n                                          <span>• {d}</span>\r\n                                          <span className=\"flex shrink-0 gap-1\">\r\n                                            <button\r\n                                              onClick={() => handleCopyDrill(d)}\r\n                                              className=\"rounded-full bg-slate-800 px-2 py-[1px] text-[10px] hover:bg-slate-700\"\r\n                                              title=\"Copy drill text\"\r\n                                            >\r\n                                              Copy\r\n                                            </button>\r\n                                            <a\r\n                                              href={`https://www.youtube.com/results?search_query=${encodeURIComponent(\r\n                                                d\r\n                                              )}`}\r\n                                              target=\"_blank\"\r\n                                              rel=\"noreferrer\"\r\n                                              className=\"rounded-full bg-slate-800 px-2 py-[1px] text-[10px] hover:bg-slate-700\"\r\n                                              title=\"Search drill on YouTube\"\r\n                                            >\r\n                                              YouTube\r\n                                            </a>\r\n                                          </span>\r\n                                        </li>\r\n                                      ))}\r\n                                    </ul>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Right column: collapsible 14-day plan */}\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"rounded-2xl border border-slate-800 bg-slate-900/75 p-4\">\r\n                    <div\r\n                      className=\"flex cursor-pointer items-center justify-between gap-2\"\r\n                      onClick={() => setPlanOpen((v) => !v)}\r\n                    >\r\n                      <div>\r\n                        <h3 className=\"text-sm font-semibold tracking-tight text-slate-100\">\r\n                          14-Day Practice Plan\r\n                        </h3>\r\n                        <p className=\"mt-1 text-[11px] text-slate-400\">\r\n                          Click to show or hide. Each is a focused 15–20 minute\r\n                          session.\r\n                        </p>\r\n                      </div>\r\n                      <span className=\"text-[11px] text-slate-300\">\r\n                        {planOpen ? \"Hide plan ▲\" : \"Show plan ▼\"}\r\n                      </span>\r\n                    </div>\r\n\r\n                    {planOpen && (\r\n                      <ol className=\"mt-3 space-y-1 text-[13px] text-slate-200\">\r\n                        {report.practicePlan14Day.map((item, i) => (\r\n                          <li key={i}>\r\n                            <span className=\"mr-1 text-slate-400\">\r\n                              {String(i + 1).padStart(2, \"0\")}:\r\n                            </span>\r\n                            {item}\r\n                          </li>\r\n                        ))}\r\n                      </ol>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </section>\r\n          )}\r\n\r\n          {/* Saved reports list */}\r\n          {savedReports.length > 0 && (\r\n            <section className=\"mt-4 rounded-2xl border border-slate-800 bg-slate-900/70 p-4\">\r\n              <h2 className=\"text-sm font-semibold tracking-tight text-slate-100\">\r\n                Saved reports\r\n              </h2>\r\n              <p className=\"mt-1 text-[11px] text-slate-400\">\r\n                Click a report to reload it. Newest reports appear first.\r\n              </p>\r\n              <div className=\"mt-2 flex flex-wrap gap-2 text-[11px]\">\r\n                {savedReports.map((sr) => (\r\n                  <button\r\n                    key={sr.id}\r\n                    onClick={() => handleLoadSavedReport(sr)}\r\n                    className=\"rounded-full border border-slate-700 bg-slate-950 px-3 py-1 text-left text-slate-200 hover:border-emerald-500/60\"\r\n                  >\r\n                    <span className=\"font-semibold mr-1\">{sr.playerName}</span>\r\n                    <span className=\"text-slate-400\">\r\n                      {new Date(sr.createdAt).toLocaleString()}\r\n                    </span>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </section>\r\n          )}\r\n\r\n          {error && view === \"report\" && (\r\n            <p className=\"text-xs text-red-400\">Error: {error}</p>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ScoreRow({ label, value }: { label: string; value: number }) {\r\n  const clamped = Math.max(0, Math.min(100, value ?? 0));\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-between gap-2 text-xs\">\r\n      <span className=\"text-slate-200\">{label}</span>\r\n      <div className=\"flex items-center gap-2\">\r\n        <div className=\"h-1.5 w-24 overflow-hidden rounded-full bg-slate-800\">\r\n          <div\r\n            className=\"h-full rounded-full bg-emerald-500\"\r\n            style={{ width: `${clamped}%` }}\r\n          />\r\n        </div>\r\n        <span className=\"w-8 text-right text-slate-300\">{clamped}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ListBlock({\r\n  title,\r\n  items,\r\n  numbered,\r\n}: {\r\n  title: string;\r\n  items: string[];\r\n  numbered?: boolean;\r\n}) {\r\n  return (\r\n    <div>\r\n      <p className=\"text-xs font-semibold uppercase tracking-wide text-slate-400\">\r\n        {title}\r\n      </p>\r\n      {numbered ? (\r\n        <ol className=\"mt-1 space-y-[2px] text-[13px] text-slate-200\">\r\n          {items.map((item, i) => (\r\n            <li key={i}>\r\n              <span className=\"mr-1 text-slate-400\">\r\n                {String(i + 1).padStart(2, \"0\")}:\r\n              </span>\r\n              {item}\r\n            </li>\r\n          ))}\r\n        </ol>\r\n      ) : (\r\n        <ul className=\"mt-1 space-y-[2px] text-[13px] text-slate-200\">\r\n          {items.map((item, i) => (\r\n            <li key={i}>• {item}</li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}