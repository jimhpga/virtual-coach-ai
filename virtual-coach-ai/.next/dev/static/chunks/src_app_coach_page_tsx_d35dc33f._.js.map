{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Sites/virtual-coach-ai/virtual-coach-ai/src/app/coach/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\ntype ReportCheckpoint = {\r\n  id: string;\r\n  label: string;\r\n  status: \"ON_TRACK\" | \"NEEDS_ATTENTION\" | \"PRIORITY\";\r\n  phase: string;\r\n  coachNotes: string;\r\n  commonMisses: string[];\r\n  keyDrills: string[];\r\n};\r\n\r\ntype FullSwingReport = {\r\n  playerOverview: string;\r\n  scores: {\r\n    overall: number;\r\n    power: number;\r\n    reliability: number;\r\n    consistency: number;\r\n  };\r\n  strengths: string[];\r\n  leaks: string[];\r\n  topFixes: string[];\r\n  checkpoints: ReportCheckpoint[];\r\n  practicePlan14Day: string[];\r\n};\r\n\r\ntype SavedReport = {\r\n  id: string;\r\n  playerName: string;\r\n  createdAt: string;\r\n  report: FullSwingReport;\r\n};\r\n\r\ntype VideoAnalysis = {\r\n  summary: string;\r\n  keyPositions: {\r\n    label: string;\r\n    focus: string;\r\n    notes: string;\r\n  }[];\r\n  matchesToCheckpoints: string[];\r\n  swingKeysOnCourse: string[];\r\n};\r\n\r\nconst STORAGE_KEY = \"virtual-coach-saved-reports\";\r\n\r\nfunction StatusBadge({ status }: { status: ReportCheckpoint[\"status\"] }) {\r\n  let label = \"\";\r\n  let color = \"\";\r\n\r\n  switch (status) {\r\n    case \"ON_TRACK\":\r\n      label = \"On Track\";\r\n      color = \"bg-emerald-500/15 text-emerald-300 border-emerald-500/40\";\r\n      break;\r\n    case \"NEEDS_ATTENTION\":\r\n      label = \"Needs Attention\";\r\n      color = \"bg-amber-500/15 text-amber-300 border-amber-500/40\";\r\n      break;\r\n    case \"PRIORITY\":\r\n      label = \"Priority\";\r\n      color = \"bg-red-500/15 text-red-300 border-red-500/40\";\r\n      break;\r\n    default:\r\n      label = status;\r\n      color = \"bg-slate-700/60 text-slate-200 border-slate-500/40\";\r\n  }\r\n\r\n  return (\r\n    <span\r\n      className={`inline-flex items-center rounded-full border px-2 py-[2px] text-[10px] font-semibold uppercase tracking-wide ${color}`}\r\n    >\r\n      {label}\r\n    </span>\r\n  );\r\n}\r\n\r\nexport default function CoachPage() {\r\n  const [playerName, setPlayerName] = useState(\"Player\");\r\n  const [age, setAge] = useState(\"\");\r\n  const [handicap, setHandicap] = useState(\"\");\r\n  const [typicalBallFlight, setTypicalBallFlight] = useState(\"Slight fade\");\r\n  const [typicalMiss, setTypicalMiss] = useState(\"Low pull\");\r\n  const [goals, setGoals] = useState(\r\n    \"More fairways with driver and more solid irons.\"\r\n  );\r\n  const [notes, setNotes] = useState(\r\n    \"Struggles with consistency under pressure and with longer clubs.\"\r\n  );\r\n\r\n  const [report, setReport] = useState<FullSwingReport | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const [audioLoading, setAudioLoading] = useState(false);\r\n  const audioRef = useRef<HTMLAudioElement | null>(null);\r\n\r\n  const [savedReports, setSavedReports] = useState<SavedReport[]>([]);\r\n  const [saving, setSaving] = useState(false);\r\n\r\n  // Video upload state\r\n  const [videoUrl, setVideoUrl] = useState<string | null>(null);\r\n  const [videoName, setVideoName] = useState<string | null>(null);\r\n  const previousVideoUrl = useRef<string | null>(null);\r\n\r\n  // Video analysis state\r\n  const [videoAnalysis, setVideoAnalysis] = useState<VideoAnalysis | null>(null);\r\n  const [videoAnalyzing, setVideoAnalyzing] = useState(false);\r\n\r\n  // Q&A near the video\r\n  const [qaQuestion, setQaQuestion] = useState(\"\");\r\n  const [qaAnswer, setQaAnswer] = useState<string | null>(null);\r\n  const [qaLoading, setQaLoading] = useState(false);\r\n\r\n  // Checkpoint expand/collapse\r\n  const [expandedIds, setExpandedIds] = useState<string[]>([]);\r\n\r\n  // Simple two-step view: \"input\" vs \"report\"\r\n  const [view, setView] = useState<\"input\" | \"report\">(\"input\");\r\n\r\n  // Practice plan collapsed?\r\n  const [planOpen, setPlanOpen] = useState(false);\r\n\r\n  // Load saved reports from localStorage on mount\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n    try {\r\n      const raw = window.localStorage.getItem(STORAGE_KEY);\r\n      if (!raw) return;\r\n      const parsed = JSON.parse(raw) as SavedReport[];\r\n      if (Array.isArray(parsed)) {\r\n        setSavedReports(parsed);\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n  }, []);\r\n\r\n  // Save reports to localStorage when list changes\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n    try {\r\n      window.localStorage.setItem(STORAGE_KEY, JSON.stringify(savedReports));\r\n    } catch {\r\n      // ignore\r\n    }\r\n  }, [savedReports]);\r\n\r\n  // Cleanup old object URLs when video changes/unmounts\r\n  useEffect(() => {\r\n    return () => {\r\n      if (previousVideoUrl.current) {\r\n        URL.revokeObjectURL(previousVideoUrl.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  async function handleGenerateReport() {\r\n    setLoading(true);\r\n    setError(null);\r\n    setReport(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/full-swing-report\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          playerName,\r\n          age,\r\n          handicap,\r\n          typicalBallFlight,\r\n          typicalMiss,\r\n          goals,\r\n          notes,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok || !data.ok) {\r\n        throw new Error(data.error || \"Request failed\");\r\n      }\r\n\r\n      setReport(data.report as FullSwingReport);\r\n      setView(\"report\");\r\n    } catch (e: any) {\r\n      console.error(e);\r\n      setError(e.message || \"Something went wrong.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function handlePlayOverview() {\r\n    if (!report || !report.playerOverview) return;\r\n\r\n    setAudioLoading(true);\r\n    try {\r\n      const res = await fetch(\"/api/tts\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ text: report.playerOverview }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok || !data.ok) {\r\n        throw new Error(data.error || \"TTS request failed\");\r\n      }\r\n\r\n      const url = `data:${data.mimeType || \"audio/mpeg\"};base64,${data.audio}`;\r\n\r\n      if (audioRef.current) {\r\n        audioRef.current.pause();\r\n      }\r\n\r\n      const audio = new Audio(url);\r\n      audioRef.current = audio;\r\n      audio.play();\r\n    } catch (e: any) {\r\n      console.error(e);\r\n      setError(e.message || \"Failed to play audio.\");\r\n    } finally {\r\n      setAudioLoading(false);\r\n    }\r\n  }\r\n\r\n  function handleResetForm() {\r\n    setPlayerName(\"Player\");\r\n    setAge(\"\");\r\n    setHandicap(\"\");\r\n    setTypicalBallFlight(\"Slight fade\");\r\n    setTypicalMiss(\"Low pull\");\r\n    setGoals(\"More fairways with driver and more solid irons.\");\r\n    setNotes(\"Struggles with consistency under pressure and with longer clubs.\");\r\n    setReport(null);\r\n    setError(null);\r\n    setVideoUrl(null);\r\n    setVideoName(null);\r\n    setVideoAnalysis(null);\r\n    setQaQuestion(\"\");\r\n    setQaAnswer(null);\r\n    setExpandedIds([]);\r\n    setPlanOpen(false);\r\n    setView(\"input\");\r\n  }\r\n\r\n  function handlePrintReport() {\r\n    if (!report) {\r\n      setError(\"Generate a report before printing.\");\r\n      return;\r\n    }\r\n    if (typeof window !== \"undefined\") {\r\n      window.print();\r\n    }\r\n  }\r\n\r\n  function handleSaveReport() {\r\n    if (!report) {\r\n      setError(\"Generate a report before saving.\");\r\n      return;\r\n    }\r\n    setSaving(true);\r\n    try {\r\n      const id = `${Date.now()}`;\r\n      const createdAt = new Date().toISOString();\r\n      const newSaved: SavedReport = {\r\n        id,\r\n        playerName: playerName || \"Player\",\r\n        createdAt,\r\n        report,\r\n      };\r\n      setSavedReports((prev) => [newSaved, ...prev].slice(0, 20));\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  }\r\n\r\n  function handleLoadSavedReport(saved: SavedReport) {\r\n    setReport(saved.report);\r\n    setPlayerName(saved.playerName);\r\n    setError(null);\r\n    setView(\"report\");\r\n  }\r\n\r\n  async function handleCopyDrill(drill: string) {\r\n    try {\r\n      if (typeof navigator !== \"undefined\" && navigator.clipboard) {\r\n        await navigator.clipboard.writeText(drill);\r\n      }\r\n    } catch (e) {\r\n      console.error(\"clipboard error\", e);\r\n    }\r\n  }\r\n\r\n  function handleVideoChange(e: any) {\r\n    const file = e.target.files?.[0];\r\n    if (!file) {\r\n      setVideoUrl(null);\r\n      setVideoName(null);\r\n      setVideoAnalysis(null);\r\n      return;\r\n    }\r\n\r\n    if (previousVideoUrl.current) {\r\n      URL.revokeObjectURL(previousVideoUrl.current);\r\n    }\r\n\r\n    const url = URL.createObjectURL(file);\r\n    previousVideoUrl.current = url;\r\n    setVideoUrl(url);\r\n    setVideoName(file.name);\r\n    setVideoAnalysis(null);\r\n    setQaAnswer(null);\r\n  }\r\n\r\n  async function handleAnalyzeVideo() {\r\n    if (!videoUrl && !notes && !typicalBallFlight && !typicalMiss) {\r\n      setError(\"Add some notes or a video before running analysis.\");\r\n      return;\r\n    }\r\n\r\n    setVideoAnalyzing(true);\r\n    setError(null);\r\n    setVideoAnalysis(null);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/video-analysis\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          playerName,\r\n          typicalBallFlight,\r\n          typicalMiss,\r\n          goals,\r\n          notes,\r\n          videoName,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok || !data.ok) {\r\n        throw new Error(data.error || \"Video analysis request failed\");\r\n      }\r\n\r\n      setVideoAnalysis(data.analysis as VideoAnalysis);\r\n    } catch (e: any) {\r\n      console.error(e);\r\n      setError(e.message || \"Failed to analyze video.\");\r\n    } finally {\r\n      setVideoAnalyzing(false);\r\n    }\r\n  }\r\n\r\n  async function handleAskQuestion() {\r\n    if (!qaQuestion.trim()) return;\r\n\r\n    setQaLoading(true);\r\n    setQaAnswer(null);\r\n    setError(null);\r\n\r\n    const context = `\r\nPlayer: ${playerName}\r\nBall flight: ${typicalBallFlight}\r\nMiss: ${typicalMiss}\r\nGoals: ${goals}\r\nNotes: ${notes}\r\nVideo file: ${videoName || \"none\"}\r\n`.trim();\r\n\r\n    try {\r\n      const res = await fetch(\"/api/test-ai\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          prompt: `Context:\\n${context}\\n\\nPlayer question about this swing:\\n${qaQuestion}`,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok || !data.ok) {\r\n        throw new Error(data.error || \"Question request failed\");\r\n      }\r\n\r\n      setQaAnswer(data.answer as string);\r\n    } catch (e: any) {\r\n      console.error(e);\r\n      setError(e.message || \"Failed to answer question.\");\r\n    } finally {\r\n      setQaLoading(false);\r\n    }\r\n  }\r\n\r\n  function toggleCheckpoint(id: string) {\r\n    setExpandedIds((prev) =>\r\n      prev.includes(id) ? prev.filter((x) => x !== id) : [...prev, id]\r\n    );\r\n  }\r\n\r\n  function shortText(text: string) {\r\n    if (!text) return \"\";\r\n    const firstSentence = text.split(/(?<=[.!?])\\s+/)[0];\r\n    return firstSentence.length > 180\r\n      ? firstSentence.slice(0, 177) + \"...\"\r\n      : firstSentence;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen text-slate-100\">\r\n      {/* semi-dark overlay with blur over the global golf background */}\r\n      <div className=\"min-h-screen bg-slate-950/55 backdrop-blur-md\">\r\n        <div className=\"mx-auto flex w-full max-w-6xl flex-col gap-4 p-6 pb-10\">\r\n          {/* Top navigation bar with logo */}\r\n          <nav className=\"mb-1 flex items-center justify-between rounded-full border border-slate-700/60 bg-slate-900/35 px-4 py-2 text-xs backdrop-blur-lg shadow-lg\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"flex items-center gap-2 border-r border-slate-700/60 pr-3\">\r\n                <img\r\n                  src=\"/logo.png\"  // logo in /public/logo.png\r\n                  alt=\"Virtual Coach AI\"\r\n                  className=\"h-8 w-auto drop-shadow-xl\"\r\n                />\r\n                <span className=\"text-[11px] font-semibold uppercase tracking-wide text-slate-200\">\r\n                  Virtual Coach AI\r\n                </span>\r\n              </div>\r\n              <a\r\n                href=\"/\"\r\n                className=\"rounded-full bg-slate-900/60 px-3 py-1 font-semibold text-slate-100 hover:bg-slate-800/80\"\r\n              >\r\n                ← Back to home\r\n              </a>\r\n              <button\r\n                onClick={handleResetForm}\r\n                className=\"rounded-full bg-slate-900/60 px-3 py-1 font-semibold text-slate-100 hover:bg-slate-800/80\"\r\n              >\r\n                Upload another swing\r\n              </button>\r\n              <div className=\"ml-2 flex gap-1 rounded-full bg-slate-900/50 px-1 py-1\">\r\n                <button\r\n                  onClick={() => setView(\"input\")}\r\n                  className={`rounded-full px-3 py-1 text-[11px] font-semibold ${\r\n                    view === \"input\"\r\n                      ? \"bg-slate-700/80 text-slate-50\"\r\n                      : \"text-slate-300\"\r\n                  }`}\r\n                >\r\n                  Upload\r\n                </button>\r\n                <button\r\n                  onClick={() => setView(\"report\")}\r\n                  disabled={!report}\r\n                  className={`rounded-full px-3 py-1 text-[11px] font-semibold ${\r\n                    view === \"report\"\r\n                      ? \"bg-slate-700/80 text-slate-50\"\r\n                      : \"text-slate-300\"\r\n                  } ${!report ? \"opacity-40\" : \"\"}`}\r\n                >\r\n                  Report\r\n                </button>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <button\r\n                onClick={handleSaveReport}\r\n                disabled={saving || !report}\r\n                className=\"rounded-full bg-slate-900/70 px-3 py-1 font-semibold text-slate-100 disabled:opacity-60\"\r\n              >\r\n                {saving ? \"Saving...\" : \"Save report\"}\r\n              </button>\r\n              <button\r\n                onClick={handlePrintReport}\r\n                className=\"rounded-full bg-emerald-500 px-3 py-1 font-semibold text-emerald-950 hover:bg-emerald-400\"\r\n              >\r\n                Print / PDF\r\n              </button>\r\n            </div>\r\n          </nav>\r\n\r\n          {/* Header */}\r\n          <header className=\"flex flex-col gap-2 border-b border-slate-700/60 pb-4\">\r\n            <h1 className=\"text-3xl font-bold tracking-tight\">\r\n              Virtual Coach AI\r\n            </h1>\r\n            <p className=\"max-w-3xl text-sm text-slate-200\">\r\n              Generate a structured full-swing report from a single set of notes.\r\n              Fill in the player details, attach a swing video, hit{\" \"}\r\n              <span className=\"font-semibold\">Generate Report</span>, and the AI\r\n              will build an overview, checkpoints, and a 14-day practice plan.\r\n            </p>\r\n          </header>\r\n\r\n          {/* INPUT VIEW */}\r\n          {view === \"input\" && (\r\n            <>\r\n              {/* Input form + video upload */}\r\n              <section className=\"grid gap-4 rounded-2xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-5 shadow-xl md:grid-cols-3\">\r\n                <div className=\"space-y-3 md:col-span-2\">\r\n                  <div className=\"grid gap-3 md:grid-cols-3\">\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-200\">\r\n                        Player name\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950/70 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={playerName}\r\n                        onChange={(e) => setPlayerName(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-200\">\r\n                        Age\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950/70 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={age}\r\n                        onChange={(e) => setAge(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-200\">\r\n                        Handicap / scoring average\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950/70 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={handicap}\r\n                        onChange={(e) => setHandicap(e.target.value)}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid gap-3 md:grid-cols-2\">\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-200\">\r\n                        Typical ball flight\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950/70 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={typicalBallFlight}\r\n                        onChange={(e) => setTypicalBallFlight(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label className=\"text-xs font-medium text-slate-200\">\r\n                        Most common miss\r\n                      </label>\r\n                      <input\r\n                        className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950/70 px-2 py-1.5 text-sm outline-none focus:border-emerald-500\"\r\n                        value={typicalMiss}\r\n                        onChange={(e) => setTypicalMiss(e.target.value)}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"text-xs font-medium text-slate-200\">\r\n                      Goals for your full swing\r\n                    </label>\r\n                    <textarea\r\n                      className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950/70 px-2 py-2 text-sm outline-none focus:border-emerald-500\"\r\n                      rows={2}\r\n                      value={goals}\r\n                      onChange={(e) => setGoals(e.target.value)}\r\n                    />\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"text-xs font-medium text-slate-200\">\r\n                      Notes from lesson / self-diagnosis\r\n                    </label>\r\n                    <textarea\r\n                      className=\"mt-1 w-full rounded-md border border-slate-700 bg-slate-950/70 px-2 py-2 text-sm outline-none focus:border-emerald-500\"\r\n                      rows={3}\r\n                      value={notes}\r\n                      onChange={(e) => setNotes(e.target.value)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex flex-col justify-between gap-4 rounded-xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-4 shadow-lg\">\r\n                  <div className=\"space-y-3 text-sm text-slate-200\">\r\n                    <p className=\"font-semibold text-slate-50\">\r\n                      How this report is generated\r\n                    </p>\r\n                    <p className=\"text-xs text-slate-200\">\r\n                      Your inputs (and optionally your swing video) stay on your\r\n                      device. The written notes are sent securely to Virtual Coach\r\n                      AI to build a structured report: scores, checkpoints, and a\r\n                      14-day practice plan.\r\n                    </p>\r\n\r\n                    <div className=\"mt-2 space-y-1\">\r\n                      <label className=\"text-xs font-medium text-slate-200\">\r\n                        Swing video (optional)\r\n                      </label>\r\n                      <input\r\n                        type=\"file\"\r\n                        accept=\"video/*\"\r\n                        onChange={handleVideoChange}\r\n                        className=\"block w-full text-[11px] text-slate-200 file:mr-3 file:rounded-md file:border-0 file:bg-slate-800/80 file:px-3 file:py-1.5 file:text-xs file:font-semibold file:text-slate-100 hover:file:bg-slate-700\"\r\n                      />\r\n                      {videoName && (\r\n                        <p className=\"truncate text-[11px] text-slate-300\">\r\n                          Selected: {videoName}\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <button\r\n                    onClick={handleGenerateReport}\r\n                    disabled={loading}\r\n                    className=\"mt-2 inline-flex items-center justify-center rounded-md bg-emerald-500 px-4 py-2 text-sm font-semibold text-emerald-950 shadow-sm disabled:opacity-60\"\r\n                  >\r\n                    {loading ? \"Generating report...\" : \"Generate Full Swing Report\"}\r\n                  </button>\r\n                  {error && (\r\n                    <p className=\"text-xs text-red-400\">Error: {error}</p>\r\n                  )}\r\n                </div>\r\n              </section>\r\n\r\n              {/* Small video preview + Q&A */}\r\n              {videoUrl && (\r\n                <section className=\"rounded-2xl border border-slate-700/60 bg-slate-900/35 backdrop-blur-lg p-4 shadow-xl\">\r\n                  <div className=\"mb-2 flex items-center justify-between gap-2\">\r\n                    <h2 className=\"text-sm font-semibold tracking-tight text-slate-50\">\r\n                      Swing video & quick questions\r\n                    </h2>\r\n                    <button\r\n                      onClick={handleAnalyzeVideo}\r\n                      disabled={videoAnalyzing}\r\n                      className=\"rounded-full bg-emerald-500 px-3 py-1 text-[11px] font-semibold text-emerald-950 disabled:opacity-60\"\r\n                    >\r\n                      {videoAnalyzing ? \"Analyzing...\" : \"Analyze video with AI\"}\r\n                    </button>\r\n                  </div>\r\n                  <div className=\"grid items-start gap-4 md:grid-cols-[auto,1fr]\">\r\n                    <div className=\"max-w-xs rounded-xl bg-black/80 px-3 py-2 shadow-lg\">\r\n                      <video\r\n                        controls\r\n                        src={videoUrl}\r\n                        className=\"w-full rounded-md\"\r\n                      />\r\n                      <p className=\"mt-1 text-center text-[11px] text-slate-300\">\r\n                        Small preview – just to see the motion.\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"flex flex-col gap-3\">\r\n                      <div className=\"rounded-xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-3 shadow\">\r\n                        <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-slate-300\">\r\n                          Ask a follow-up question\r\n                        </p>\r\n                        <p className=\"mb-2 text-[11px] text-slate-300\">\r\n                          Answered using this swing, your ball flight, miss\r\n                          pattern, goals, and notes.\r\n                        </p>\r\n                        <textarea\r\n                          className=\"w-full rounded-md border border-slate-700 bg-slate-950/70 px-2 py-2 text-sm outline-none focus:border-emerald-500\"\r\n                          rows={3}\r\n                          value={qaQuestion}\r\n                          onChange={(e) => setQaQuestion(e.target.value)}\r\n                          placeholder=\"Example: What one feel should I use with this driver swing on the course?\"\r\n                        />\r\n                        <button\r\n                          onClick={handleAskQuestion}\r\n                          disabled={qaLoading || !qaQuestion.trim()}\r\n                          className=\"mt-2 inline-flex items-center justify-center rounded-md bg-slate-800/80 px-3 py-1.5 text-xs font-semibold text-slate-100 disabled:opacity-50\"\r\n                        >\r\n                          {qaLoading ? \"Thinking...\" : \"Ask about this swing\"}\r\n                        </button>\r\n                      </div>\r\n                      {qaAnswer && (\r\n                        <div className=\"rounded-xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-3 shadow\">\r\n                          <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-slate-300\">\r\n                            Coach answer\r\n                          </p>\r\n                          <p className=\"whitespace-pre-wrap text-[13px] leading-relaxed text-slate-50\">\r\n                            {qaAnswer}\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n                      {!qaAnswer && videoAnalysis && (\r\n                        <div className=\"rounded-xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-3 shadow\">\r\n                          <p className=\"mb-1 text-xs font-semibold uppercase tracking-wide text-slate-300\">\r\n                            Video analysis (AI)\r\n                          </p>\r\n                          <p className=\"text-[12px] leading-relaxed text-slate-50\">\r\n                            {videoAnalysis.summary}\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </section>\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          {/* REPORT VIEW */}\r\n          {view === \"report\" && report && (\r\n            <section className=\"space-y-4\">\r\n              <div className=\"grid gap-4 md:grid-cols-[2fr,1.1fr]\">\r\n                <div className=\"space-y-4\">\r\n                  {/* Player overview */}\r\n                  <div className=\"rounded-2xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-4 shadow-xl\">\r\n                    <div className=\"flex flex-wrap items-center justify-between gap-2\">\r\n                      <div>\r\n                        <h2 className=\"text-lg font-semibold tracking-tight\">\r\n                          Player Overview\r\n                        </h2>\r\n                        <p className=\"mt-1 text-[11px] text-slate-300\">\r\n                          Where you are now and how we'll sharpen your full swing.\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <button\r\n                          onClick={handlePlayOverview}\r\n                          disabled={audioLoading}\r\n                          className=\"inline-flex items-center rounded-full bg-slate-800/80 px-3 py-1 text-[11px] font-semibold text-slate-100 disabled:opacity-60\"\r\n                        >\r\n                          {audioLoading ? \"Preparing audio...\" : \"▶ Play overview\"}\r\n                        </button>\r\n                        <span className=\"rounded-full bg-emerald-500/15 px-2 py-[2px] text-[10px] font-semibold uppercase tracking-wide text-emerald-300\">\r\n                          Generated by Virtual Coach AI\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                    <p className=\"mt-3 whitespace-pre-wrap text-sm leading-relaxed text-slate-50\">\r\n                      {report.playerOverview}\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* Power & Reliability */}\r\n                  <div className=\"rounded-2xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-4 shadow-xl\">\r\n                    <h3 className=\"text-sm font-semibold tracking-tight text-slate-50\">\r\n                      Power &amp; Reliability\r\n                    </h3>\r\n                    <p className=\"mt-1 text-[11px] text-slate-300\">\r\n                      Scores estimated from your notes and described patterns. They\r\n                      should roughly match the story in the overview.\r\n                    </p>\r\n\r\n                    <div className=\"mt-3 space-y-2\">\r\n                      <ScoreRow label=\"Overall\" value={report.scores.overall} />\r\n                      <ScoreRow label=\"Power\" value={report.scores.power} />\r\n                      <ScoreRow\r\n                        label=\"Reliability\"\r\n                        value={report.scores.reliability}\r\n                      />\r\n                      <ScoreRow\r\n                        label=\"Consistency\"\r\n                        value={report.scores.consistency}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Three boxes side by side */}\r\n                  <div className=\"grid gap-4 md:grid-cols-3\">\r\n                    <div className=\"rounded-2xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-4 text-sm shadow\">\r\n                      <ListBlock title=\"What you do well\" items={report.strengths} />\r\n                    </div>\r\n                    <div className=\"rounded-2xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-4 text-sm shadow\">\r\n                      <ListBlock title=\"Where your leaks are\" items={report.leaks} />\r\n                    </div>\r\n                    <div className=\"rounded-2xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-4 text-sm shadow\">\r\n                      <ListBlock\r\n                        title=\"Top 3 power moves\"\r\n                        items={report.topFixes}\r\n                        numbered\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* P1–P9 Checkpoints */}\r\n                  <div className=\"rounded-2xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-4 shadow-xl\">\r\n                    <div className=\"mb-3 flex items-center justify-between\">\r\n                      <h3 className=\"text-sm font-semibold tracking-tight text-slate-50\">\r\n                        P1–P9 Checkpoints\r\n                      </h3>\r\n                      <p className=\"text-[11px] text-slate-300\">\r\n                        Short summary on each row. Click to see full description,\r\n                        misses, and drills.\r\n                      </p>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      {report.checkpoints.map((cp, index) => {\r\n                        const id = cp.id || `cp-${index}`;\r\n                        const expanded = expandedIds.includes(id);\r\n                        return (\r\n                          <div\r\n                            key={id}\r\n                            className=\"rounded-xl border border-slate-700/60 bg-slate-950/50 backdrop-blur-lg shadow\"\r\n                          >\r\n                            <button\r\n                              onClick={() => toggleCheckpoint(id)}\r\n                              className=\"flex w-full items-center justify-between gap-3 px-3 py-2 text-left\"\r\n                            >\r\n                              <div className=\"flex flex-col gap-[2px]\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <span className=\"text-[11px] font-semibold uppercase tracking-wide text-slate-300\">\r\n                                    {cp.phase || `P${index + 1}`}\r\n                                  </span>\r\n                                  <span className=\"text-[11px] text-slate-400\">\r\n                                    P{index + 1}\r\n                                  </span>\r\n                                </div>\r\n                                <p className=\"text-sm font-semibold text-slate-50\">\r\n                                  {cp.label}\r\n                                </p>\r\n                                <p className=\"text-[11px] text-slate-200\">\r\n                                  {shortText(cp.coachNotes)}\r\n                                </p>\r\n                              </div>\r\n                              <div className=\"flex flex-col items-end gap-1\">\r\n                                <StatusBadge status={cp.status} />\r\n                                <span className=\"text-[11px] text-slate-300\">\r\n                                  {expanded ? \"Hide details ▲\" : \"Show details ▼\"}\r\n                                </span>\r\n                              </div>\r\n                            </button>\r\n\r\n                            {expanded && (\r\n                              <div className=\"border-t border-slate-700/60 px-3 py-3 text-[11px] text-slate-100\">\r\n                                <p className=\"mb-2 text-[13px] leading-relaxed\">\r\n                                  {cp.coachNotes}\r\n                                </p>\r\n                                <div className=\"grid gap-2 md:grid-cols-3\">\r\n                                  <div>\r\n                                    <p className=\"font-semibold text-slate-100\">\r\n                                      Common misses\r\n                                    </p>\r\n                                    <ul className=\"mt-1 space-y-[2px]\">\r\n                                      {cp.commonMisses.map((m, i) => (\r\n                                        <li key={i}>• {m}</li>\r\n                                      ))}\r\n                                    </ul>\r\n                                  </div>\r\n                                  <div className=\"md:col-span-2\">\r\n                                    <p className=\"font-semibold text-slate-100\">\r\n                                      Key drills\r\n                                    </p>\r\n                                    <ul className=\"mt-1 space-y-[2px]\">\r\n                                      {cp.keyDrills.map((d, i) => (\r\n                                        <li\r\n                                          key={i}\r\n                                          className=\"flex items-center justify-between gap-2\"\r\n                                        >\r\n                                          <span>• {d}</span>\r\n                                          <span className=\"flex shrink-0 gap-1\">\r\n                                            <button\r\n                                              onClick={() => handleCopyDrill(d)}\r\n                                              className=\"rounded-full bg-slate-800/80 px-2 py-[1px] text-[10px] hover:bg-slate-700\"\r\n                                              title=\"Copy drill text\"\r\n                                            >\r\n                                              Copy\r\n                                            </button>\r\n                                            <a\r\n                                              href={`https://www.youtube.com/results?search_query=${encodeURIComponent(\r\n                                                d\r\n                                              )}`}\r\n                                              target=\"_blank\"\r\n                                              rel=\"noreferrer\"\r\n                                              className=\"rounded-full bg-slate-800/80 px-2 py-[1px] text-[10px] hover:bg-slate-700\"\r\n                                              title=\"Search drill on YouTube\"\r\n                                            >\r\n                                              YouTube\r\n                                            </a>\r\n                                          </span>\r\n                                        </li>\r\n                                      ))}\r\n                                    </ul>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Right column: collapsible 14-day plan */}\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"rounded-2xl border border-slate-700/60 bg-slate-900/40 backdrop-blur-lg p-4 shadow-xl\">\r\n                    <div\r\n                      className=\"flex cursor-pointer items-center justify-between gap-2\"\r\n                      onClick={() => setPlanOpen((v) => !v)}\r\n                    >\r\n                      <div>\r\n                        <h3 className=\"text-sm font-semibold tracking-tight text-slate-50\">\r\n                          14-Day Practice Plan\r\n                        </h3>\r\n                        <p className=\"mt-1 text-[11px] text-slate-300\">\r\n                          Click to show or hide. Each is a focused 15–20 minute\r\n                          session.\r\n                        </p>\r\n                      </div>\r\n                      <span className=\"text-[11px] text-slate-200\">\r\n                        {planOpen ? \"Hide plan ▲\" : \"Show plan ▼\"}\r\n                      </span>\r\n                    </div>\r\n\r\n                    {planOpen && (\r\n                      <ol className=\"mt-3 space-y-1 text-[13px] text-slate-50\">\r\n                        {report.practicePlan14Day.map((item, i) => (\r\n                          <li key={i}>\r\n                            <span className=\"mr-1 text-slate-300\">\r\n                              {String(i + 1).padStart(2, \"0\")}:\r\n                            </span>\r\n                            {item}\r\n                          </li>\r\n                        ))}\r\n                      </ol>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </section>\r\n          )}\r\n\r\n          {/* Saved reports list */}\r\n          {savedReports.length > 0 && (\r\n            <section className=\"mt-4 rounded-2xl border border-slate-700/60 bg-slate-900/35 backdrop-blur-lg p-4 shadow-xl\">\r\n              <h2 className=\"text-sm font-semibold tracking-tight text-slate-50\">\r\n                Saved reports\r\n              </h2>\r\n              <p className=\"mt-1 text-[11px] text-slate-300\">\r\n                Click a report to reload it. Newest reports appear first.\r\n              </p>\r\n              <div className=\"mt-2 flex flex-wrap gap-2 text-[11px]\">\r\n                {savedReports.map((sr) => (\r\n                  <button\r\n                    key={sr.id}\r\n                    onClick={() => handleLoadSavedReport(sr)}\r\n                    className=\"rounded-full border border-slate-700 bg-slate-950/60 px-3 py-1 text-left text-slate-100 hover:border-emerald-500/60\"\r\n                  >\r\n                    <span className=\"mr-1 font-semibold\">{sr.playerName}</span>\r\n                    <span className=\"text-slate-300\">\r\n                      {new Date(sr.createdAt).toLocaleString()}\r\n                    </span>\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </section>\r\n          )}\r\n\r\n          {error && view === \"report\" && (\r\n            <p className=\"text-xs text-red-400\">Error: {error}</p>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ScoreRow({ label, value }: { label: string; value: number }) {\r\n  const clamped = Math.max(0, Math.min(100, value ?? 0));\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-between gap-2 text-xs\">\r\n      <span className=\"text-slate-200\">{label}</span>\r\n      <div className=\"flex items-center gap-2\">\r\n        <div className=\"h-1.5 w-24 overflow-hidden rounded-full bg-slate-800/70\">\r\n          <div\r\n            className=\"h-full rounded-full bg-emerald-500\"\r\n            style={{ width: `${clamped}%` }}\r\n          />\r\n        </div>\r\n        <span className=\"w-8 text-right text-slate-300\">{clamped}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ListBlock({\r\n  title,\r\n  items,\r\n  numbered,\r\n}: {\r\n  title: string;\r\n  items: string[];\r\n  numbered?: boolean;\r\n}) {\r\n  return (\r\n    <div>\r\n      <p className=\"text-xs font-semibold uppercase tracking-wide text-slate-300\">\r\n        {title}\r\n      </p>\r\n      {numbered ? (\r\n        <ol className=\"mt-1 space-y-[2px] text-[13px] text-slate-50\">\r\n          {items.map((item, i) => (\r\n            <li key={i}>\r\n              <span className=\"mr-1 text-slate-300\">\r\n                {String(i + 1).padStart(2, \"0\")}:\r\n              </span>\r\n              {item}\r\n            </li>\r\n          ))}\r\n        </ol>\r\n      ) : (\r\n        <ul className=\"mt-1 space-y-[2px] text-[13px] text-slate-50\">\r\n          {items.map((item, i) => (\r\n            <li key={i}>• {item}</li>\r\n          ))}\r\n        </ul>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}