<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Virtual Coach AI — Upload</title>
<link rel="preload" as="image" href="/homepage-background.png" />
<style>
  :root{
    --nav: rgba(7,68,32,.96);
    --scrim: rgba(0,0,0,.06);
    --panel: rgba(10,18,24,.24);
    --line: rgba(255,255,255,.10);
    --text: #ecf3f7; --muted:#cfe0e6;
    --radius: 14px; --shadow: 0 8px 24px rgba(0,0,0,.20);
    --maxw: 980px;
  }
  *{box-sizing:border-box} html,body{height:100%}
  body{
    margin:0; color:var(--text);
    font:16px/1.5 system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial;
    background:url('/homepage-background.png') center/cover fixed no-repeat;
  }
  .scrim{min-height:100vh;background:var(--scrim)}
  .wrap{width:min(var(--maxw),94%);margin:0 auto;padding:18px 0 42px}
  header{position:sticky;top:0;z-index:20;background:var(--nav);border-bottom:1px solid rgba(255,255,255,.1)}
  .navwrap{width:min(var(--maxw),94%);margin:0 auto;padding:10px 0;display:flex;gap:16px;align-items:center;justify-content:space-between}
  .brand{display:flex;align-items:center;gap:10px;color:#fff;text-decoration:none;font-weight:800}
  nav a{color:#fff;text-decoration:none;padding:8px 10px;border-radius:10px;border:1px solid transparent}
  nav a:hover{background:rgba(255,255,255,.08)}
  nav a[aria-current="page"]{border-color:rgba(255,255,255,.18);background:rgba(255,255,255,.10)}

  .card{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);backdrop-filter:blur(1.5px);padding:16px}
  h1{margin:0 0 6px} .muted{color:var(--muted)}
  .grid{display:grid;gap:12px}
  @media(min-width:820px){.grid{grid-template-columns:1fr 1fr}}
  label{display:block;margin:8px 0 6px}
  input[type="file"],select{width:100%;padding:10px;border:1px solid var(--line);border-radius:10px;background:rgba(255,255,255,.08);color:#fff}
  .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  button{border:1px solid var(--line);background:rgba(255,255,255,.10);color:#fff;padding:10px 14px;border-radius:12px;cursor:pointer}
  button.primary{background:rgba(25,195,125,.18);border-color:#2a6}
  button:hover{background:rgba(255,255,255,.16)}
  .hint{font-size:12px;color:#cfe0e6;margin-top:6px}
  .ok{color:#8fe6ba}
</style>
</head>
<body>
  <!-- Shared nav -->
  <header>
    <div class="navwrap">
      <a class="brand" href="/"><img src="/virtualcoach-logo-transparent.png" alt="Virtual Coach AI" style="height:30px"><span>Virtual Coach AI</span></a>
      <nav aria-label="Primary">
        <a href="/index.html">Home</a>
        <a href="/report.html?report=/report.json">Reports</a>
        <a href="/coming-soon.html">Coming&nbsp;Soon</a>
        <a href="/pricing.html">Pricing</a>
        <a href="/faq.html">FAQ</a>
        <a href="/contact.html">Contact</a>
        <a href="/login.html">Login</a>
      </nav>
    </div>
  </header>

  <div class="scrim">
    <main class="wrap">
      <section class="card">
        <h1>Upload Your Swing</h1>
        <div class="muted">Pick one or two videos from your device. We’ll attach them to the sample report and send you to the report page.</div>

        <div class="grid" style="margin-top:10px">
          <div>
            <label for="fo">Face-On Video (optional)</label>
            <input id="fo" type="file" accept="video/*" />
            <div class="hint">MP4/MOV from your phone works great.</div>
          </div>
          <div>
            <label for="dtl">Down-the-Line Video (optional)</label>
            <input id="dtl" type="file" accept="video/*" />
            <div class="hint">Pick either or both. We’ll link them in P1–P9.</div>
          </div>
        </div>

        <div class="grid" style="margin-top:10px">
          <div>
            <label for="mode">Discipline</label>
            <select id="mode">
              <option value="full-swing" selected>Full Swing</option>
              <option value="chipping">Chipping</option>
              <option value="putting">Putting</option>
            </select>
          </div>
          <div>
            <label for="swings">Swings</label>
            <select id="swings">
              <option>1</option><option>2</option><option>3</option><option>5</option><option>10</option>
            </select>
          </div>
        </div>

        <div class="row">
          <button id="build" class="primary">Build Report</button>
          <button id="demo">Use Demo Only</button>
          <span id="msg" class="hint"></span>
        </div>
      </section>
    </main>
  </div>

<script>
(async function(){
  const $ = s => document.querySelector(s);
  const msg = $('#msg');

  async function readSample(){
    const res = await fetch('/report.json', { cache:'no-store' });
    if(!res.ok) throw new Error('report.json HTTP '+res.status);
    const txt = await res.text();
    return JSON.parse(txt.trim().replace(/^\uFEFF/, ''));
  }
  function blobFor(file){ return file ? URL.createObjectURL(file) : ''; }

  async function makeReport(fromFiles){
    msg.textContent = 'Building...';
    try{
      const base = await readSample();

      // Apply simple header choices
      base.discipline = $('#mode').value;
      base.swings = +$('#swings').value || 1;

      // Attach videos if provided
      let refs = [];
      if (fromFiles) {
        const fo  = $('#fo').files[0];
        const dtl = $('#dtl').files[0];
        const foUrl  = blobFor(fo);
        const dtlUrl = blobFor(dtl);
        // Alternate FO/DTL links across P-sections for variety.
        refs = [foUrl, dtlUrl].filter(Boolean);
        if (!refs.length) fromFiles = false; // nothing chosen
      }

      if (fromFiles && base.phases && base.phases.length){
        for (let i=0;i<base.phases.length;i++){
          const ref = refs.length ? refs[i % refs.length] : '';
          if (ref) base.phases[i].ref = ref; // report.html will label as “Video”
        }
      }

      // Save to session and go render
      sessionStorage.setItem('vc_report', JSON.stringify(base));
      msg.innerHTML = '<span class="ok">Done. Opening report…</span>';
      // IMPORTANT: use src=session so report uses sessionStorage instead of a URL
      location.href = '/report.html?src=session';
    }catch(e){
      console.error(e);
      msg.textContent = 'Error: ' + (e.message || String(e));
    }
  }

  $('#build').addEventListener('click', ()=>makeReport(true));
  $('#demo').addEventListener('click',  ()=>makeReport(false));
})();
</script>
</body>
</html>
