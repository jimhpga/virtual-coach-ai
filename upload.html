<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Virtual Coach AI – Intake & Upload</title>
  <style>
    :root{
      --vca-green:#0f7a3e; /* logo green */
      --vca-green-2:#0c5f31;
      --text:#ffffff;
      --muted:#d7e5db;
      --bg:#0a0f0d;
      --glass: rgba(255,255,255,.08);
      --glass-2: rgba(255,255,255,.12);
      --ok:#6ad488;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text); background:#0a0f0d center/cover fixed no-repeat; /* image set by JS for exact match */
      min-height:100dvh;
    }
    /* subtle darkening overlay for readability */
    body::before{content:""; position:fixed; inset:0; background:linear-gradient(180deg, rgba(10,15,13,.72), rgba(10,15,13,.72)); z-index:-1}

    header{
      position:sticky; top:0; backdrop-filter:saturate(120%) blur(8px);
      background:linear-gradient(180deg, rgba(15,122,62,.85), rgba(12,95,49,.85));
      border-bottom:1px solid rgba(255,255,255,.15); z-index:50;
    }
    .wrap{max-width:1100px; margin:0 auto; padding:14px 18px;}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{
      width:36px; height:36px; border-radius:10px; background:radial-gradient(circle at 30% 30%, #35d08d, #0f7a3e 70%);
      box-shadow: 0 0 0 2px rgba(255,255,255,.15) inset, 0 8px 24px rgba(0,0,0,.25);
      display:grid; place-items:center; font-weight:700; color:#fff; font-size:18px;
    }
    .brand h1{font-size:18px; margin:0; letter-spacing:.2px; font-weight:700}
    nav{margin-left:auto; display:flex; gap:8px;}
    .row{display:flex; align-items:center; gap:16px}
    .btn-tab{
      appearance:none; border:1px solid rgba(255,255,255,.2); background:transparent; color:#fff; padding:8px 12px; border-radius:999px; cursor:pointer; font-weight:600;
    }
    .btn-tab[aria-current="page"]{background:var(--glass-2)}

    .hero{padding:28px 18px 12px}
    .hero h2{margin:0; font-size:36px; line-height:1.05}
    .sub{opacity:.9; margin-top:6px}

    section.card{background:var(--glass); border:1px solid rgba(255,255,255,.12); border-radius:18px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.25); margin:0 18px 18px}
    @media(min-width:900px){
      section.card.split{display:grid; grid-template-columns: 6fr 6fr; gap:18px}
      section.card{margin:0 0 18px}
    }

    h3{margin:8px 0 10px; font-size:18px; letter-spacing:.2px}
    .muted{color:var(--muted)}

    form .grid{display:grid; grid-template-columns: repeat(12, 1fr); gap:14px}
    .field{grid-column: span 12; display:flex; flex-direction:column; gap:6px}
    @media(min-width:720px){.half{grid-column: span 6}}
    label{font-size:13px; opacity:.9}
    input[type="text"], input[type="email"], select, textarea, input[type="number"]{
      width:100%; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.20); color:#fff; background: rgba(255,255,255,.06);
      outline:none; box-shadow: 0 2px 0 rgba(255,255,255,.05) inset;
    }
    textarea{min-height:90px; resize:vertical}
    .chips{display:flex; flex-wrap:wrap; gap:8px}
    .chip{padding:9px 12px; border-radius:999px; border:1px solid rgba(255,255,255,.22); background:rgba(255,255,255,.06); cursor:pointer; user-select:none}
    .chip[aria-pressed="true"]{background:rgba(106,212,136,.18); border-color:#6ad488}

    .actions{display:flex; gap:10px; flex-wrap:wrap}
    .btn{
      appearance:none; border:none; background:linear-gradient(180deg, #34c77f, #199a57); color:#03150d; font-weight:800; letter-spacing:.2px;
      padding:12px 16px; border-radius:12px; cursor:pointer; box-shadow:0 8px 24px rgba(25,154,87,.35); text-transform:uppercase; font-size:12px
    }
    .btn.secondary{background:transparent; color:#fff; border:1px solid rgba(255,255,255,.25)}
    .note{font-size:12px; opacity:.85; margin-left:auto}

    .panel{display:none}
    .panel.active{display:block}

    .preview{
      background:rgba(0,0,0,.25); border:1px dashed rgba(255,255,255,.25); border-radius:12px; padding:12px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:12px; max-height:260px; overflow:auto
    }

    .pill{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.15); border-radius:999px}
    .badge-ok{background:rgba(106,212,136,.18); border-color:#6ad488}

    /* translucent selects per Jim's preference */
    select{backdrop-filter: blur(2px)}

    footer{opacity:.75; text-align:center; padding:40px 10px}
  </style>
</head>
<body>
  <header>
    <div class="wrap row">
      <div class="brand">
        <div class="logo" aria-hidden>V</div>
        <h1>Virtual Coach AI</h1>
      </div>
      <nav class="row" role="tablist" aria-label="Main">
        <button class="btn-tab" data-tab="home" aria-current="page">Home</button>
        <button class="btn-tab" data-tab="upload">Upload</button>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <div class="hero">
      <h2>Where the future of golf instruction is built<span class="muted"> — and tested.</span></h2>
      <p class="sub">Fill the quick intake once. Your feedback + swing = <span class="pill badge-ok">Smarter coaching</span>.</p>
    </div>

    <!-- HOME / INTAKE PANEL -->
    <section id="panel-home" class="panel active">
      <section class="card split">
        <div>
          <h3>1) Player Profile</h3>
          <form id="intake-form" onsubmit="return false;">
            <div class="grid">
              <div class="field half">
                <label for="name">Name</label>
                <input id="name" name="name" type="text" placeholder="Jane or John Golfer" required />
              </div>
              <div class="field half">
                <label for="email">Email</label>
                <input id="email" name="email" type="email" placeholder="you@example.com" required />
              </div>

              <div class="field half">
                <label for="hand">Handedness</label>
                <select id="hand" name="hand" required>
                  <option value="">Select…</option>
                  <option>Right‑handed</option>
                  <option>Left‑handed</option>
                  <option>Ambidextrous</option>
                </select>
              </div>
              <div class="field half">
                <label for="eye">Eye Dominance</label>
                <select id="eye" name="eye" required>
                  <option value="">Select…</option>
                  <option>Right‑eye dominant</option>
                  <option>Left‑eye dominant</option>
                  <option>Unsure</option>
                </select>
              </div>

              <div class="field half">
                <label for="experience">Experience</label>
                <select id="experience" name="experience" required>
                  <option value="">Select…</option>
                  <option>Beginner</option>
                  <option>Intermediate</option>
                  <option>Advanced</option>
                  <option>Pro/Coach</option>
                </select>
              </div>
              <div class="field half">
                <label for="age">Age (optional)</label>
                <input id="age" name="age" type="number" min="5" max="100" placeholder="—" />
              </div>

              <div class="field">
                <label>Primary goals</label>
                <div class="chips" data-name="goals">
                  <div class="chip" role="button">More distance</div>
                  <div class="chip" role="button">Straighter</div>
                  <div class="chip" role="button">Consistency</div>
                  <div class="chip" role="button">Wedge control</div>
                  <div class="chip" role="button">Putting</div>
                  <div class="chip" role="button">Tournament prep</div>
                </div>
              </div>

              <div class="field">
                <label for="injury">Any pain or limitations?</label>
                <textarea id="injury" name="injury" placeholder="e.g., tight neck, weak glutes, can’t touch toes…"></textarea>
              </div>
            </div>

            <h3>2) Swing Context</h3>
            <div class="grid">
              <div class="field half">
                <label for="club">Typical club in video</label>
                <select id="club" name="club">
                  <option value="">Select…</option>
                  <option>Driver</option>
                  <option>Fairway wood</option>
                  <option>Hybrid</option>
                  <option>Long iron</option>
                  <option>Mid iron</option>
                  <option>Short iron</option>
                  <option>Wedge</option>
                  <option>Putter</option>
                </select>
              </div>
              <div class="field half">
                <label for="view">Camera view</label>
                <select id="view" name="view">
                  <option value="">Select…</option>
                  <option>Down‑the‑line</option>
                  <option>Face‑on</option>
                  <option>Ground‑up (Torque View)</option>
                  <option>Other</option>
                </select>
              </div>
              <div class="field">
                <label for="notes">Anything we should know?</label>
                <textarea id="notes" name="notes" placeholder="Windy day, range mat, post‑workout, etc."></textarea>
              </div>
            </div>

            <h3>3) Preferences</h3>
            <div class="grid">
              <div class="field half">
                <label for="report">Report style</label>
                <select id="report" name="report">
                  <option>Quick Fix (1‑page)</option>
                  <option>Full Report (P1–P9)</option>
                  <option>Power Report</option>
                  <option>Putting Package</option>
                </select>
              </div>
              <div class="field half">
                <label for="voice">Voice feedback</label>
                <select id="voice" name="voice">
                  <option>On</option>
                  <option>Off</option>
                </select>
              </div>
              <div class="field">
                <label>Avatar mode</label>
                <div class="chips" data-name="avatar">
                  <div class="chip" role="button">Skeleton</div>
                  <div class="chip" role="button">Exoskeleton</div>
                  <div class="chip" role="button">Human</div>
                </div>
              </div>
            </div>

            <div class="actions" style="margin-top:6px">
              <button class="btn" id="save-intake">Save Intake</button>
              <button class="btn secondary" id="reset-intake" type="button">Reset</button>
              <span class="note">Takes ~1 minute to analyze a typical 3–7s clip.</span>
            </div>

            <div id="intake-preview" class="preview" style="margin-top:12px; display:none"></div>
          </form>
        </div>

        <div>
          <h3>What happens next?</h3>
          <ul class="muted" style="margin-top:8px">
            <li>P1–P9 sequence strip</li>
            <li>Power & Efficiency report</li>
            <li>Fault map + instant drill prescriptions</li>
            <li>Optional voice summary clip</li>
          </ul>
          <p class="muted">Already filled this out? Jump straight to <button class="btn-tab" data-tab="upload">Upload</button>.</p>
          <p class="muted">Your data stays private. No sharing. No nonsense.</p>
        </div>
      </section>
    </section>

    <!-- UPLOAD PANEL -->
    <section id="panel-upload" class="panel">
      <section class="card">
        <h3>Upload Swing</h3>
        <div class="grid">
          <div class="field half">
            <label for="video">Swing video (3–10s works best)</label>
            <input type="file" id="video" accept="video/*" />
          </div>
          <div class="field half">
            <label>Status</label>
            <div id="status" class="pill">Idle</div>
          </div>
          <div class="field" style="grid-column: span 12">
            <video id="preview" controls playsinline style="width:100%; max-height:360px; display:none; border-radius:12px; background:#000"></video>
          </div>
        </div>

        <h3 style="margin-top:8px">Intake Summary</h3>
        <div id="upload-intake" class="preview">No intake saved yet. Go to Home → Save Intake.</div>

        <div class="actions" style="margin-top:12px">
          <button class="btn" id="submit">Submit for Analysis</button>
          <button class="btn secondary" id="clear-video" type="button">Clear Video</button>
          <span class="note">If it says “Analyzing locally” forever, refresh the page.</span>
        </div>

        <div id="payload" class="preview" style="margin-top:12px; display:none"></div>
      </section>
    </section>
  </main>

  <footer>
    <small>© Virtual Coach AI — Built to help you hit it farther, straighter, and with fewer swear words.</small>
  </footer>

  <script>
    // === Perfect-match background loader ===
    // Tries known repo images so this page matches your existing /upload.html background
    (function setExactBackground(){
      const candidates = [
        'homepage-background.png',
        'golf-course-bg.jpg',
        'virtualcoach-bg.png',
        '/homepage-background.png',
        '/golf-course-bg.jpg',
        '/virtualcoach-bg.png'
      ];
      const img = new Image();
      let i = 0;
      function tryNext(){
        if(i>=candidates.length) return; // keep default bg color if none found
        const url = candidates[i++];
        img.onload = ()=>{ document.body.style.backgroundImage = `url('${url}')`; };
        img.onerror = tryNext;
        img.src = url + (url.includes('?')?'':'?v=' + Date.now());
      }
      tryNext();
    })();

    // Simple tab router
    const tabs = document.querySelectorAll('.btn-tab');
    const panels = {
      home: document.getElementById('panel-home'),
      upload: document.getElementById('panel-upload')
    };
    tabs.forEach(btn=>btn.addEventListener('click',()=>{
      const tab = btn.getAttribute('data-tab');
      tabs.forEach(b=>b.removeAttribute('aria-current'));
      btn.setAttribute('aria-current','page');
      Object.values(panels).forEach(p=>p.classList.remove('active'));
      panels[tab].classList.add('active');
      if(tab==='upload') loadUploadIntake();
      window.scrollTo({top:0, behavior:'smooth'});
    }));

    // Chips toggle logic
    document.querySelectorAll('.chips').forEach(group=>{
      group.addEventListener('click', e=>{
        const chip = e.target.closest('.chip');
        if(!chip) return;
        chip.setAttribute('aria-pressed', chip.getAttribute('aria-pressed')!=="true");
      });
    });

    // Save intake
    const saveBtn = document.getElementById('save-intake');
    const resetBtn = document.getElementById('reset-intake');
    const form = document.getElementById('intake-form');
    const preview = document.getElementById('intake-preview');

    saveBtn.addEventListener('click', ()=>{
      const data = Object.fromEntries(new FormData(form).entries());
      // collect chip groups
      document.querySelectorAll('.chips').forEach(group=>{
        const name = group.dataset.name;
        const selected = [...group.querySelectorAll('.chip[aria-pressed="true"]')].map(c=>c.textContent.trim());
        if(selected.length) data[name] = selected;
      });
      localStorage.setItem('vca_intake', JSON.stringify(data));
      preview.style.display = 'block';
      preview.textContent = JSON.stringify(data, null, 2);
      // visual toast
      saveBtn.textContent = 'Saved ✓';
      setTimeout(()=>saveBtn.textContent='Save Intake', 1400);
    });

    resetBtn.addEventListener('click', ()=>{
      form.reset();
      document.querySelectorAll('.chip[aria-pressed="true"]').forEach(c=>c.removeAttribute('aria-pressed'));
      localStorage.removeItem('vca_intake');
      preview.style.display = 'none';
    });

    // Load intake into upload panel
    function loadUploadIntake(){
      const el = document.getElementById('upload-intake');
      const raw = localStorage.getItem('vca_intake');
      if(!raw){el.textContent = 'No intake saved yet. Go to Home → Save Intake.'; return;}
      try { el.textContent = JSON.stringify(JSON.parse(raw), null, 2) } catch{ el.textContent = raw }
    }

    // Video preview
    const inputVideo = document.getElementById('video');
    const vid = document.getElementById('preview');
    const status = document.getElementById('status');

    inputVideo.addEventListener('change', ()=>{
      const file = inputVideo.files?.[0];
      if(!file){ status.textContent='Idle'; vid.style.display='none'; vid.removeAttribute('src'); return; }
      const url = URL.createObjectURL(file);
      vid.src = url; vid.style.display='block';
      status.textContent = 'Selected • Ready to upload';
    });

    document.getElementById('clear-video').addEventListener('click',()=>{
      inputVideo.value=""; vid.pause(); vid.removeAttribute('src'); vid.load(); vid.style.display='none';
      status.textContent='Idle';
    });

    // Submit (mock endpoint). Replace with real fetch to your API.
    const submit = document.getElementById('submit');
    const payload = document.getElementById('payload');

    submit.addEventListener('click', async ()=>{
      const intake = localStorage.getItem('vca_intake');
      if(!intake){ alert('Save your intake on Home first.'); return; }
      const file = inputVideo.files?.[0];
      if(!file){ alert('Choose a swing video.'); return; }
      status.textContent = 'Analyzing locally…';

      // Prepare multipart payload
      const formData = new FormData();
      formData.append('intake', intake);
      formData.append('video', file, file.name);

      // Demo: show payload preview instead of sending
      payload.style.display='block';
      payload.textContent = `POST /api/analyze
Headers: (multipart/form-data)
Intake:
${intake}

Video: ${file.name} (${Math.round(file.size/1024)} KB)`;

      // TODO: uncomment and set your endpoint
      // try{
      //   const res = await fetch('/api/analyze', { method:'POST', body: formData });
      //   if(!res.ok) throw new Error('Network error');
      //   const data = await res.json();
      //   status.textContent = 'Uploaded • Processing';
      //   console.log('Server response', data);
      // } catch(err){
      //   console.error(err);
      //   status.textContent = 'Upload failed';
      // }
    });

    // Autofill form if intake exists
    (function hydrate(){
      const raw = localStorage.getItem('vca_intake');
      if(!raw) return;
      try{
        const data = JSON.parse(raw);
        for(const [k,v] of Object.entries(data)){
          const el = document.getElementById('intake-form').elements[k];
          if(!el) continue;
          if(el instanceof HTMLInputElement || el instanceof HTMLTextAreaElement || el instanceof HTMLSelectElement){
            el.value = v;
          }
        }
        // hydrate chips
        document.querySelectorAll('.chips').forEach(group=>{
          const name = group.dataset.name; if(!data[name]) return;
          [...group.children].forEach(chip=>{
            if(data[name].includes(chip.textContent.trim())) chip.setAttribute('aria-pressed','true');
          });
        });
      }catch{}
    })();
  </script>
</body>
</html>
