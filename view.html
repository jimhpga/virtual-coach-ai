<!DOCTYPE html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Virtual Coach – Report</title>
<style>
  body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:24px;line-height:1.4}
  .card{border:1px solid #ddd;border-radius:12px;padding:16px;margin:12px 0}
  .muted{color:#666}.err{color:#b00020}button{padding:8px 12px;border-radius:8px;border:1px solid #ddd;background:#f7f7f7;cursor:pointer}
  input[type=url]{width:100%}
</style></head><body>
<h1>Virtual Coach – Report</h1>
<div class="card">
  <p class="muted">Paste a signed JSON URL, or open this page from your email link.</p>
  <input id="url" type="url" placeholder="https://...signed S3 URL..." />
  <div style="margin-top:8px"><button id="open">Open</button></div>
</div>
<div id="out"></div>
<script>
const qs=new URL(location.href).searchParams;
const els={url:document.getElementById('url'),open:document.getElementById('open'),out:document.getElementById('out')};
const fmt=d=>{try{return new Date(d).toLocaleString()}catch{return String(d)}};
const err=m=>els.out.innerHTML='<p class="err">Error: '+m+'</p>';
async function load(u){
  els.out.innerHTML='<p class="muted">Loading…</p>';
  try{
    const r=await fetch(u); const t=await r.text(); let j; try{j=JSON.parse(t)}catch{throw new Error('Invalid JSON')}
    if(!r.ok) throw new Error('HTTP '+r.status);
    const rep=j?.data?.report||{}; const when=j?.data?.receivedAt;
    els.out.innerHTML = `
      <div class="card">
        <h2 style="margin:0 0 8px">Swing Report — P1–P9</h2>
        <div class="muted">Date: ${fmt(when)} • Client: ${rep.clientId??'—'}</div>
        <div style="margin-top:8px"><b>Swing Score:</b> ${rep.swingScore??'—'}</div>
        ${rep.note?`<div style="margin-top:8px"><b>Note:</b> ${rep.note}</div>`:''}
        <div style="margin-top:12px"><a href="${u}" target="_blank" rel="noopener">Open raw JSON</a></div>
      </div>`;
  }catch(e){err(e.message||e)}
}
els.open.onclick=()=>{if(els.url.value)load(els.url.value.trim())};
if(qs.get('url')){els.url.value=qs.get('url');load(els.url.value)}
</script></body></html>
