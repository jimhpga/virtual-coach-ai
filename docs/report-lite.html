<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Virtual Coach AI — Report (Lite)</title>
<style>
  :root{--bg:#0e1a22;--panel:#16242e;--muted:#8aa5b5;--text:#ecf3f7;--ok:#19c37d;--warn:#f6c453;--bad:#ff6b6b}
  *{box-sizing:border-box} body{margin:0;color:var(--text);font:16px system-ui;background:#0e1a22}
  .bg{position:fixed;inset:0;background:url('homepage-background.png') center/cover no-repeat fixed;opacity:.35;z-index:-1}
  .wrap{max-width:1080px;margin:24px auto;padding:0 16px}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:14px}
  .title{font-weight:800;font-size:24px} .sub{color:var(--muted);font-size:13px}
  .btn{background:#16242e;border:1px solid #223743;color:var(--text);border-radius:10px;padding:8px 10px;cursor:pointer}
  .grid{display:grid;gap:12px} @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
  .card,details{background:rgba(22,36,46,.9);border:1px solid #223743;border-radius:12px}
  .card h3{margin:0;padding:12px 14px;border-bottom:1px solid #1f3340}
  .card .content{padding:12px 14px}
  details>summary{list-style:none;display:flex;gap:10px;align-items:center;padding:12px 14px;cursor:pointer}
  .metric{display:flex;align-items:center;gap:10px;margin:8px 0}
  .name{flex:0 0 210px;color:#cfe3ee}.bar{flex:1;height:10px;border-radius:999px;background:#10222c;border:1px solid #22404f;position:relative}
  .bar>span{position:absolute;inset:0;width:0}.ok{background:linear-gradient(90deg,var(--ok),#2bd897)}.warn{background:linear-gradient(90deg,var(--warn),#ffd479)}.bad{background:linear-gradient(90deg,var(--bad),#ff8f8f)}
  .pct{width:52px;text-align:right;color:#cfe3ee}.chip{font-size:12px;color:var(--muted);border:1px solid #27404f;border-radius:999px;padding:2px 8px}
</style>
</head>
<body>
<div class="bg" aria-hidden="true"></div>
<div class="wrap">
  <header>
    <div>
      <div class="title">Swing Report — P1–P9</div>
      <div class="sub">Date: <span id="date"></span> • Mode: <span id="mode">Full Swing</span></div>
    </div>
    <div>
      <button id="reload" class="btn">Reload Report</button>
      <button id="sample" class="btn">Load Sample</button>
    </div>
  </header>

  <div id="status" class="sub"></div>
  <div id="error" class="sub" style="color:#ff9a9a"></div>

  <section class="grid">
    <div class="card">
      <h3>Swing Consistency</h3>
      <div id="swing" class="content"></div>
    </div>
    <div class="card">
      <h3>Position Consistency</h3>
      <div id="position" class="content"></div>
    </div>
  </section>

  <section class="card" style="margin-top:12px">
    <h3>Power Score Summary</h3>
    <div id="power" class="content"></div>
  </section>

  <section style="margin-top:12px">
    <div class="sub">Click a P-section to expand.</div>
    <div id="plist"></div>
  </section>
</div>

<script>
const fmt=v=>`${v}%`, band=v=>v>=75?'ok':v>=55?'warn':'bad';
const metricRow=m=>`<div class="metric"><div class="name">${m.label}</div><div class="bar"><span class="${band(m.value)}" style="width:${m.value}%"></span></div><div class="pct">${fmt(m.value)}</div></div>`;
const posRow=p=>`<div class="metric"><div class="name">${p.p}</div><div class="bar"><span class="${band(p.value)}" style="width:${p.value}%"></span></div><div class="pct">${fmt(p.value)}</div></div>`;

function renderReport(data){
  document.getElementById('date').textContent = new Date().toLocaleDateString();
  if(data.discipline) document.getElementById('mode').textContent = /putt/i.test(data.discipline)?'Putting':/chip/i.test(data.discipline)?'Chipping':'Full Swing';
  // swing & position
  const swingHtml = (data.swing_metrics||[]).map(metricRow).join('') || '<div class="sub">No swing metrics.</div>';
  const posHtml = (data.position_metrics||[]).map(posRow).join('') || '<div class="sub">No position metrics.</div>';
  document.getElementById('swing').innerHTML = swingHtml;
  document.getElementById('position').innerHTML = posHtml;
  // power
  const p = data.power||{score:0,tempo:'—',release_timing:0};
  document.getElementById('power').innerHTML =
    `<div class="metric"><div class="name">Power Score</div><div class="bar"><span class="${band(p.score)}" style="width:${p.score}%"></span></div><div class="pct">${fmt(p.score)}</div></div>
     <div class="metric"><div class="name">Tempo</div><div class="bar"><span class="ok" style="width:76%"></span></div><div class="pct">${p.tempo}</div></div>
     <div class="metric"><div class="name">Release Timing</div><div class="bar"><span class="${band(+p.release_timing)}" style="width:${+p.release_timing||0}%"></span></div><div class="pct">${+p.release_timing||0}%</div></div>`;
  // P1–P9
  const plist = document.getElementById('plist');
  const phases = data.phases||[];
  plist.innerHTML = phases.map((ph,i)=>`
    <details ${i===0?'open':''} class="card" style="margin-top:10px">
      <summary><span class="chip">${ph.id||('P'+(i+1))}</span> <strong style="margin-left:8px">${ph.name||''}</strong> <span class="chip" style="margin-left:8px">${(ph.grade||'ok').toUpperCase()}</span></summary>
      <div class="content">
        <div class="sub" style="margin-bottom:8px">${ph.short||''}</div>
        <div>${ph.long||''}</div>
      </div>
    </details>
  `).join('') || '<div class="sub">No phases.</div>';
}

async function loadReport(url){
  const s=document.getElementById('status'), e=document.getElementById('error');
  e.textContent=''; s.textContent='Loading '+url+'…';
  try{
    const res = await fetch(url,{cache:'no-store'});
    if(!res.ok){ s.textContent=''; e.textContent='Could not load report ('+res.status+'). Check path: '+url; return; }
    const data = await res.json();
    renderReport(data); s.textContent='Loaded report: '+url;
  }catch(err){ s.textContent=''; e.textContent='Failed to load report: '+(err?.message||String(err)); }
}

const sample = {
  swings:1, discipline:'full-swing',
  power:{score:78, tempo:'3.0:1', release_timing:62},
  swing_metrics:[{label:'Right Arm Angle',value:84},{label:'Club Face Angle',value:79}],
  position_metrics:[{p:'P1',value:90},{p:'P2',value:74},{p:'P3',value:61},{p:'P4',value:55},{p:'P5',value:63},{p:'P6',value:70},{p:'P7',value:81},{p:'P8',value:86},{p:'P9',value:78}],
  phases:[
    {id:'P1',name:'Setup',short:'Athletic stance, posture aligned',long:'Neutral spine…',grade:'good'},
    {id:'P2',name:'Shaft Parallel (Backswing)',short:'Club parallel, early width',long:'—',grade:'ok'},
    {id:'P3',name:'Lead Arm Parallel (Backswing)',short:'Good extension, slight flat',long:'—',grade:'ok'},
    {id:'P4',name:'Top of Swing',short:'Full coil',long:'—',grade:'bad'},
    {id:'P5',name:'Lead Arm Parallel (Downswing)',short:'Arm drops inside',long:'—',grade:'good'},
    {id:'P6',name:'Shaft Parallel (Downswing)',short:'Shallowing, trail elbow leads',long:'—',grade:'good'},
    {id:'P7',name:'Impact',short:'Hips open, shaft lean',long:'—',grade:'ok'},
    {id:'P8',name:'Trail Arm Parallel (Follow-Through)',short:'Balanced extension',long:'—',grade:'good'},
    {id:'P9',name:'Finish',short:'Upright, balanced',long:'—',grade:'good'}]
};

document.getElementById('date').textContent = new Date().toLocaleDateString();
document.getElementById('reload').onclick = ()=>{
  const u = new URLSearchParams(location.search).get('report') || '/reports/demo/report.json';
  loadReport(u);
};
document.getElementById('sample').onclick = ()=>{ renderReport(sample); document.getElementById('status').textContent='Loaded sample (no fetch).'; };

// auto-load if ?report= is present
const auto = new URLSearchParams(location.search).get('report');
if(auto) loadReport(auto);
</script>
</body>
</html>




