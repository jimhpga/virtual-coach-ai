<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Virtual Coach AI — Upload</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico">
  <link rel="preload" as="image" href="homepage-background.png" />
  <style>
    :root{
      --nav:#0b2b12; --scrim:rgba(0,0,0,.06);
      --panel:rgba(10,18,24,.24); --line:rgba(255,255,255,.10);
      --text:#ecf3f7; --muted:#cfe0e6; --radius:14px; --maxw:1100px;
      --accent:#86efac;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;color:var(--text);
      font:16px/1.55 system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif;
      background:url('homepage-background.png') center/cover fixed no-repeat;
    }
    .scrim{min-height:100vh;background:var(--scrim)}
    /* NAV */
    header.top{position:sticky;top:0;z-index:100;background:var(--nav);border-bottom:1px solid rgba(255,255,255,.1)}
    .navwrap{width:min(var(--maxw),94%);margin:0 auto;padding:10px 0;display:flex;gap:12px;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px;text-decoration:none}
    .brand-logo{width:160px;height:36px;background:#fff; /* white logo */
      -webkit-mask:url('virtualcoach-logo-transparent.png') center/contain no-repeat;
              mask:url('virtualcoach-logo-transparent.png') center/contain no-repeat;}
    .vh{position:absolute;clip:rect(0 0 0 0);clip-path:inset(50%);width:1px;height:1px;overflow:hidden;white-space:nowrap}
    .menu-toggle{display:none;align-items:center;gap:8px;color:#fff;background:transparent;border:1px solid rgba(255,255,255,.3);border-radius:10px;padding:6px 10px;cursor:pointer}
    nav.nav{display:flex;gap:8px;flex-wrap:wrap}
    nav.nav a{color:#fff;text-decoration:none;padding:8px 10px;border-radius:10px;border:1px solid transparent;white-space:nowrap}
    nav.nav a:hover{background:rgba(255,255,255,.08)}
    nav.nav a[aria-current="page"]{border-color:rgba(255,255,255,.18);background:rgba(255,255,255,.10)}
    @media(max-width:820px){
      .menu-toggle{display:inline-flex}
      nav.nav{position:absolute;right:0;top:100%;background:var(--nav);border-bottom:1px solid rgba(255,255,255,.1);display:none;flex-direction:column;padding:8px}
      header.top.open nav.nav{display:flex}
    }
    /* PAGE */
    main{width:min(var(--maxw),92%);margin:0 auto;padding:22px 0 56px}
    h1{margin:0 0 8px;color:var(--accent)}
    .lead{color:var(--muted)}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);padding:16px;backdrop-filter:blur(1px)}
    .row{margin:12px 0}
    .picker{border:1px dashed rgba(255,255,255,.25);border-radius:12px;padding:16px;display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .picker.drag{background:rgba(255,255,255,.06)}
    input[type=file]{display:none}
    .badge{display:inline-block;background:rgba(255,255,255,.06);border:1px solid var(--line);color:#dff3ff;padding:6px 10px;border-radius:999px;font-size:12px}
    #log{white-space:pre-wrap;background:#0b1520;border:1px solid #123;border-radius:10px;padding:12px;min-height:120px;color:#dfe9f2;font-size:13px}
    .btn{border:1px solid var(--line);background:rgba(255,255,255,.10);color:#fff;padding:10px 14px;border-radius:10px;text-decoration:none;display:inline-flex;gap:8px;align-items:center;cursor:pointer}
    .btn:hover{background:rgba(255,255,255,.16)}
    .btn.primary{background:rgba(25,195,125,.18);border-color:#2a6}
    .progress{height:10px;border-radius:999px;background:rgba(255,255,255,.08);border:1px solid var(--line);overflow:hidden}
    .progress>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#19c37d,#2bd897)}
    footer{text-align:center;color:#cbd5cb;font-size:12px;padding:18px 0 26px}
  </style>
  <script>
    // Tiny nav toggler + auto-highlight
    addEventListener('DOMContentLoaded', ()=>{
      const header = document.getElementById('site-header');
      const btn = document.getElementById('menuBtn');
      const nav = document.getElementById('siteNav');
      if(btn && nav && header){
        btn.addEventListener('click', ()=>{
          const open = header.classList.toggle('open');
          btn.setAttribute('aria-expanded', open ? 'true' : 'false');
        });
        nav.addEventListener('click', e=>{
          if(e.target && e.target.tagName==='A'){ header.classList.remove('open'); btn.setAttribute('aria-expanded','false'); }
        });
      }
      const here = (location.pathname.split('/').pop() || 'index.html').split('?')[0];
      document.querySelectorAll('nav a').forEach(a=>{
        const href = a.getAttribute('href');
        if(href && href.split('?')[0] === here) a.setAttribute('aria-current','page');
      });
      const y = document.getElementById('y'); if (y) y.textContent = new Date().getFullYear();
    });
  </script>
</head>
<body>
<header class="top" id="site-header">
  <div class="navwrap">
    <!-- Logo only on far left -->
    <a class="brand" href="index.html" aria-label="Virtual Coach AI">
      <div class="brand-logo" aria-hidden="true"></div>
      <span class="vh">Virtual Coach AI</span>
    </a>
    <button class="menu-toggle" id="menuBtn" aria-expanded="false" aria-controls="siteNav">Menu ▾</button>
    <nav class="nav" id="siteNav" aria-label="Primary">
      <a href="index.html">Home</a>
      <a href="upload.html">Upload</a>
      <a href="report.html?report=report.json">Reports</a>
      <a href="coming-soon.html">Coming&nbsp;Soon</a>
      <a href="pricing.html">Pricing</a>
      <a href="faq.html">FAQ</a>
      <a href="contact.html">Contact</a>
      <a href="login.html">Login</a>
    </nav>
  </div>
</header>

<div class="scrim">
  <main>
    <h1>Upload → Report → Analyze</h1>
    <p class="lead">Face-on or down-the-line works best. Keep the camera steady and the swing in frame.</p>

    <section class="card">
      <div class="picker" id="drop">
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
          <label class="btn" for="file">Choose File</label>
          <input id="file" type="file" accept="video/*,.mov,.mp4,.m4v" />
          <span class="badge" id="keyBadge">(no file)</span>
        </div>
        <button id="go" class="btn primary">Upload &amp; Generate Report</button>
      </div>

      <div class="row">
        <div class="progress" aria-label="Upload progress"><span id="bar"></span></div>
      </div>

      <div class="row" id="log">Ready.</div>
    </section>
  </main>

  <footer>© <span id="y"></span> Virtual Coach AI</footer>
</div>

<script>
  const logEl = document.getElementById('log');
  const fileEl = document.getElementById('file');
  const keyBadge = document.getElementById('keyBadge');
  const goBtn = document.getElementById('go');
  const bar = document.getElementById('bar');
  const drop = document.getElementById('drop');

  const log = (m)=>{ logEl.textContent += '\\n' + m; logEl.scrollTop = logEl.scrollHeight; };
  const setKey = (k)=>{ keyBadge.textContent = k || '(no file)'; };

  function humanSize(bytes){
    const units = ['B','KB','MB','GB']; let i=0, n=bytes||0;
    while(n>=1024 && i<units.length-1){ n/=1024; i++; }
    return (Math.round(n*10)/10)+' '+units[i];
  }

  function fileChosen(f){
    if(!f) { setKey('(no file)'); return; }
    // basic validation
    const okTypes = /video\/|\.mp4$|\.mov$|\.m4v$/i;
    if(!okTypes.test(f.type) && !okTypes.test(f.name)){
      alert('Please choose a video file (.mp4, .mov, .m4v).');
      fileEl.value = '';
      setKey('(no file)');
      return;
    }
    if (f.size > 1024*1024*512){ // 512MB guard for demo
      alert('File too large for demo. Try a shorter clip (<512MB).');
      fileEl.value = '';
      setKey('(no file)');
      return;
    }
    const safeName = f.name.replace(/[^a-zA-Z0-9._-]+/g,'_');
    const key = `${Date.now()}-${safeName}`;
    setKey(safeName + ' • ' + humanSize(f.size));
    log(`Selected: ${safeName} (${humanSize(f.size)})`);

    // Try to sniff duration for UX (optional)
    try{
      const url = URL.createObjectURL(f);
      const v = document.createElement('video');
      v.preload = 'metadata';
      v.src = url;
      v.onloadedmetadata = () => {
        const d = Math.round(v.duration||0);
        if (d) log('Estimated duration: ' + d + 's');
        URL.revokeObjectURL(url);
      };
    }catch{}
  }

  fileEl.addEventListener('change', e=> fileChosen(e.target.files[0]));

  // Drag & drop
  ['dragenter','dragover'].forEach(ev=> drop.addEventListener(ev, e=>{e.preventDefault();e.stopPropagation();drop.classList.add('drag');}));
  ['dragleave','drop'].forEach(ev=> drop.addEventListener(ev, e=>{e.preventDefault();e.stopPropagation();drop.classList.remove('drag');}));
  drop.addEventListener('drop', e=>{
    const f = e.dataTransfer?.files?.[0];
    if (f){ fileEl.files = e.dataTransfer.files; fileChosen(f); }
  });

  // Demo "upload" with fake progress, then open sample report
  goBtn.onclick = async ()=>{
    const f = fileEl.files[0];
    if(!f){ alert('Pick a video first.'); return; }
    log('Uploading (demo)…');
    bar.style.width = '0%';
    let p = 0;
    const timer = setInterval(()=>{
      p = Math.min(100, p + Math.random()*18);
      bar.style.width = Math.round(p) + '%';
      if (p >= 100){ clearInterval(timer); afterUpload(); }
    }, 180);
  };

  function afterUpload(){
    log('Processing (demo)… generating report…');
    setTimeout(()=>{
      log('Opening sample report…');
      // Open the hybrid report (will load sample report.json). Change target if you prefer a different report page.
      location.href = 'report.html?report=report.json';
    }, 500);
  }
</script>
</body>
</html>
